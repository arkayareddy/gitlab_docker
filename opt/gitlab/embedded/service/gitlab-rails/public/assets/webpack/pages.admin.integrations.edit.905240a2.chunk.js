(this.webpackJsonp=this.webpackJsonp||[]).push([[112],{17:function(t,e,i){i("HVBj"),i("iooJ"),t.exports=i("SldX")},SldX:function(t,e,i){"use strict";i.r(e);var n=i("Bl6y"),r=i("jF6B"),s=i("8MWd");document.addEventListener("DOMContentLoaded",(function(){var t=document.querySelector(".js-prometheus-metrics-monitoring");(new n.a(".js-integration-settings-form").init(),t)&&new r.a(".js-prometheus-metrics-monitoring").loadActiveMetrics();Object(s.a)(document.querySelector(".js-alerts-service-settings"))}))},VQ4T:function(t,e,i){"use strict";e.a={EMPTY:"empty",LOADING:"loading",LIST:"list",NO_INTEGRATION:"no-integration"}},dsWN:function(t,e,i){"use strict";var n=i("s1D3"),r=i("4lAS"),s=i("XBTk"),a=i("Pyw5"),o=i.n(a);function c(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function u(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){c(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}const d={components:{GlIcon:n.a,GlButton:r.a},props:{title:{type:String,required:!1,default:""},dismissible:{type:Boolean,required:!1,default:!0},dismissLabel:{type:String,required:!1,default:"Dismiss"},variant:{type:String,required:!1,default:s.b.info,validator:function(t){return Object.keys(s.b).includes(t)}},primaryButtonLink:{type:String,required:!1,default:""},primaryButtonText:{type:String,required:!1,default:""},secondaryButtonLink:{type:String,required:!1,default:""},secondaryButtonText:{type:String,required:!1,default:""}},computed:{iconName:function(){return s.a[this.variant]},shouldRenderActions:function(){return Boolean(this.$slots.actions||this.actionButtons.length)},actionButtons:function(){return[{text:this.primaryButtonText,attrs:{href:this.primaryButtonLink,variant:"info",category:s.u.primary},listeners:{click:this.primaryButtonClicked}},{text:this.secondaryButtonText,attrs:{href:this.secondaryButtonLink,variant:"default",category:s.u.secondary},listeners:{click:this.secondaryButtonClicked}}].reduce((function(t,e){if(!e.text)return t;var i=u({},e.attrs);return i.href||delete i.href,t.push(u(u({},e),{},{attrs:i})),t}),[])},variantClass:function(){return"gl-alert-".concat(this.variant)}},methods:{primaryButtonClicked:function(t){this.$emit("primaryAction",t)},secondaryButtonClicked:function(t){this.$emit("secondaryAction",t)},onDismiss:function(){this.$emit("dismiss")}}};const f=o()({render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:["gl-alert",t.variantClass],attrs:{role:"alert"}},[i("gl-icon",{class:{"gl-alert-icon":!0,"gl-alert-icon-no-title":!t.title},attrs:{name:t.iconName}}),t._v(" "),t.dismissible?i("button",{ref:"dismiss",staticClass:"gl-alert-dismiss",attrs:{type:"button","aria-label":t.dismissLabel},on:{click:t.onDismiss}},[i("gl-icon",{attrs:{name:"close"}})],1):t._e(),t._v(" "),t.title?i("h4",{staticClass:"gl-alert-title"},[t._v(t._s(t.title))]):t._e(),t._v(" "),i("div",{staticClass:"gl-alert-body"},[t._t("default")],2),t._v(" "),t.shouldRenderActions?i("div",{staticClass:"gl-alert-actions"},[t._t("actions",t._l(t.actionButtons,(function(e,n){return i("gl-button",t._g(t._b({key:n,staticClass:"gl-alert-action"},"gl-button",e.attrs,!1),e.listeners),[t._v("\n        "+t._s(e.text)+"\n      ")])})))],2):t._e()],1)},staticRenderFns:[]},void 0,d,void 0,!1,void 0,!1,void 0,void 0,void 0);e.a=f},iooJ:function(t,e,i){"use strict";i.r(e);var n={};i.r(n),i.d(n,"requestStatistics",(function(){return M})),i.d(n,"fetchStatistics",(function(){return E})),i.d(n,"receiveStatisticsSuccess",(function(){return P})),i.d(n,"receiveStatisticsError",(function(){return _})),i.d(n,"default",(function(){return k}));var r={};i.r(r),i.d(r,"getStatistics",(function(){return C})),i.d(r,"default",(function(){return $}));i("t3Gg");var s=i("3a3M"),a=i.n(s),o=i("3twG");function c(){"file"===a()('input[name="blacklist_type"]:checked').val()?(a()(".blacklist-file").show(),a()(".blacklist-raw").hide()):(a()(".blacklist-file").hide(),a()(".blacklist-raw").show())}var l=i("jB52"),u=(i("va8A"),i("kO4A"),i("+kFb"),i("zCcL"),i("zpLX"),i("BD5p"),i("Id6h"),i("yi8e")),d=i("FkSe"),f=i("/lV4"),m={forks:Object(f.d)("AdminStatistics|Forks"),issues:Object(f.d)("AdminStatistics|Issues"),mergeRequests:Object(f.d)("AdminStatistics|Merge Requests"),notes:Object(f.d)("AdminStatistics|Notes"),snippets:Object(f.d)("AdminStatistics|Snippets"),sshKeys:Object(f.d)("AdminStatistics|SSH Keys"),milestones:Object(f.d)("AdminStatistics|Milestones"),activeUsers:Object(f.d)("AdminStatistics|Active Users")};function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(Object(i),!0).forEach((function(e){b(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function b(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var g,v={components:{GlLoadingIcon:d.a},data:function(){return{statisticsLabels:m}},computed:h(h({},Object(u.e)(["isLoading","statistics"])),Object(u.d)(["getStatistics"])),mounted:function(){this.fetchStatistics()},methods:h({},Object(u.c)(["fetchStatistics"]))},y=i("tBpV"),O=Object(y.a)(v,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"info-well"},[i("div",{staticClass:"well-segment admin-well admin-well-statistics"},[i("h4",[t._v(t._s(t.__("Statistics")))]),t._v(" "),t.isLoading?i("gl-loading-icon",{staticClass:"my-3",attrs:{size:"md"}}):t._l(t.getStatistics(t.statisticsLabels),(function(e){return i("p",{key:e.key,staticClass:"js-stats"},[t._v("\n        "+t._s(e.label)+"\n        "),i("span",{staticClass:"light float-right"},[t._v(t._s(e.value))])])}))],2)])}),[],!1,null,null,null).exports,j=i("qPgm"),S=i("XRO8"),w=i("NmEs"),M=function(t){return(0,t.commit)("REQUEST_STATISTICS")},E=function(t){var e=t.dispatch;e("requestStatistics"),j.a.adminStatistics().then((function(t){var i=t.data;e("receiveStatisticsSuccess",Object(w.g)(i,{deep:!0}))})).catch((function(t){return e("receiveStatisticsError",t)}))},P=function(t,e){return(0,t.commit)("RECEIVE_STATISTICS_SUCCESS",e)},_=function(t,e){(0,t.commit)("RECEIVE_STATISTICS_ERROR",e),Object(S.a)(Object(f.d)("AdminDashboard|Error loading the statistics. Please try again"))},k=function(){},C=(i("Z5ek"),function(t){return function(e){return Object.keys(e).map((function(i){return{key:i,label:e[i],value:t.statistics&&t.statistics[i]?t.statistics[i]:null}}))}}),$=function(){};function T(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var L=(T(g={},"REQUEST_STATISTICS",(function(t){t.isLoading=!0})),T(g,"RECEIVE_STATISTICS_SUCCESS",(function(t,e){t.isLoading=!1,t.error=null,t.statistics=e})),T(g,"RECEIVE_STATISTICS_ERROR",(function(t,e){t.isLoading=!1,t.error=e})),g);l.default.use(u.b);var A=function(t){if(!t)return!1;var e=new u.b.Store({actions:n,getters:r,mutations:L,state:{error:null,isLoading:!1,statistics:null}});return new l.default({el:t,store:e,components:{StatisticsPanelApp:O},render:function(t){return t(O)}})},I=(i("z4I3"),i("dj/k"),i("OZM5"),i("x/6R"),i("4ql4"),i("8Qi2"),i("MRnW"),i("GzNv"),i("tbvx"),i("orcL"),{components:{GlAlert:i("dsWN").a},props:{html:{type:String,required:!1,default:""}},data:function(){return{isDismissed:!1}},methods:{dismiss:function(){this.isDismissed=!0}}}),D=Object(y.a)(I,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.isDismissed?t._e():i("gl-alert",t._g(t._b({on:{dismiss:t.dismiss}},"gl-alert",t.$attrs,!1),t.$listeners),[i("div",{domProps:{innerHTML:t._s(t.html)}})])}),[],!1,null,null,null).exports;function B(t){return function(t){if(Array.isArray(t))return R(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return R(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return R(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function q(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function x(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?q(Object(i),!0).forEach((function(e){V(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):q(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function V(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var N=function(t){var e={html:t.innerHTML},i=x(x({},t.dataset),{},{dismissible:Object(w.H)(t.dataset.dismissible)});return new l.default({el:t,render:function(t){return t(D,{props:e,attrs:i})}})};document.addEventListener("DOMContentLoaded",(function(){return B(document.querySelectorAll(".js-vue-alert")).map(N)})),document.addEventListener("DOMContentLoaded",(function(){var t,e=document.getElementById("js-admin-statistics-container");t=a()(".change-owner-holder"),a()("input#user_force_random_password").on("change",(function(){var t=a()("#user_password, #user_password_confirmation");a()(this).attr("checked")?t.val("").prop("disabled",!0):t.prop("disabled",!1)})),a()("body").on("click",".js-toggle-colors-link",(function(t){t.preventDefault(),a()(".js-toggle-colors-container").toggleClass("hide")})),a()(".log-tabs a").on("click",(function(t){t.preventDefault(),a()(this).tab("show")})),a()(".log-bottom").on("click",(function(t){t.preventDefault();var e=a()(".file-content:visible");e.animate({scrollTop:e.find("ol").height()},"fast")})),a()(".change-owner-link").on("click",(function(e){e.preventDefault(),a()(this).hide(),t.show()})),a()(".change-owner-cancel-link").on("click",(function(e){e.preventDefault(),t.hide(),a()(".change-owner-link").show()})),a()("li.project_member, li.group_member").on("ajax:success",o.r),a()("input[name='blacklist_type']").on("click",c),c(),A(e)}))},jF6B:function(t,e,i){"use strict";i.d(e,"a",(function(){return f}));i("9U97"),i("t3Gg"),i("+kFb"),i("Id6h");var n=i("G3fq"),r=i.n(n),s=i("3a3M"),a=i.n(s),o=i("/lV4"),c=i("2ibD"),l=i("VQ4T"),u=i("NmEs");function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var f=function(){function t(e){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.backOffRequestCounter=0,this.$wrapper=a()(e),this.$monitoredMetricsPanel=this.$wrapper.find(".js-panel-monitored-metrics"),this.$monitoredMetricsCount=this.$monitoredMetricsPanel.find(".js-monitored-count"),this.$monitoredMetricsLoading=this.$monitoredMetricsPanel.find(".js-loading-metrics"),this.$monitoredMetricsEmpty=this.$monitoredMetricsPanel.find(".js-empty-metrics"),this.$monitoredMetricsList=this.$monitoredMetricsPanel.find(".js-metrics-list"),this.$missingEnvVarPanel=this.$wrapper.find(".js-panel-missing-env-vars"),this.$panelToggle=this.$missingEnvVarPanel.find(".js-panel-toggle"),this.$missingEnvVarMetricCount=this.$missingEnvVarPanel.find(".js-env-var-count"),this.$missingEnvVarMetricsList=this.$missingEnvVarPanel.find(".js-missing-var-metrics-list"),this.activeMetricsEndpoint=this.$monitoredMetricsPanel.data("activeMetrics"),this.helpMetricsPath=this.$monitoredMetricsPanel.data("metrics-help-path"),this.$panelToggle.on("click",(function(t){return i.handlePanelToggle(t)}))}var e,i,n;return e=t,(i=[{key:"init",value:function(){this.loadActiveMetrics()}},{key:"handlePanelToggle",value:function(t){var e=a()(t.currentTarget);e.closest(".card").find(".card-body").toggleClass("hidden"),e.hasClass("fa-caret-down")?e.removeClass("fa-caret-down").addClass("fa-caret-right"):e.removeClass("fa-caret-right").addClass("fa-caret-down")}},{key:"showMonitoringMetricsPanelState",value:function(t){switch(t){case l.a.LOADING:this.$monitoredMetricsLoading.removeClass("hidden"),this.$monitoredMetricsEmpty.addClass("hidden"),this.$monitoredMetricsList.addClass("hidden");break;case l.a.LIST:this.$monitoredMetricsLoading.addClass("hidden"),this.$monitoredMetricsEmpty.addClass("hidden"),this.$monitoredMetricsList.removeClass("hidden");break;default:this.$monitoredMetricsLoading.addClass("hidden"),this.$monitoredMetricsEmpty.removeClass("hidden"),this.$monitoredMetricsList.addClass("hidden")}}},{key:"populateActiveMetrics",value:function(t){var e=this,i=0,n=0,s=0;if(t.forEach((function(t){t.active_metrics>0&&(s+=1,e.$monitoredMetricsList.append("<li>".concat(r()(t.group),'<span class="badge">').concat(r()(t.active_metrics),"</span></li>")),i+=t.active_metrics,t.metrics_missing_requirements>0&&(e.$missingEnvVarMetricsList.append("<li>".concat(r()(t.group),"</li>")),n+=1))})),0===i){var a=Object(o.e)(Object(o.d)('PrometheusService|<p class="text-tertiary">No <a href="%{docsUrl}">common metrics</a> were found</p>'),{docsUrl:this.helpMetricsPath},!1);this.$monitoredMetricsEmpty.empty(),this.$monitoredMetricsEmpty.append(a),this.showMonitoringMetricsPanelState(l.a.EMPTY)}else{var c=Object(o.e)(Object(o.d)("PrometheusService|%{exporters} with %{metrics} were found"),{exporters:Object(o.c)("%d exporter","%d exporters",s),metrics:Object(o.c)("%d metric","%d metrics",i)});this.$monitoredMetricsCount.text(c),this.showMonitoringMetricsPanelState(l.a.LIST),n>0&&(this.$missingEnvVarPanel.removeClass("hidden"),this.$missingEnvVarMetricCount.text(n))}}},{key:"loadActiveMetrics",value:function(){var t=this;this.showMonitoringMetricsPanelState(l.a.LOADING),Object(u.e)((function(e,i){c.a.get(t.activeMetricsEndpoint).then((function(n){var r=n.data;r&&r.success?i(r):(t.backOffRequestCounter+=1,t.backOffRequestCounter<3?e():i(r))})).catch(i)})).then((function(e){e&&e.data&&e.data.length?t.populateActiveMetrics(e.data):t.showMonitoringMetricsPanelState(l.a.EMPTY)})).catch((function(){t.showMonitoringMetricsPanelState(l.a.EMPTY)}))}}])&&d(e.prototype,i),n&&d(e,n),t}()}},[[17,1,0,13,39]]]);
//# sourceMappingURL=pages.admin.integrations.edit.905240a2.chunk.js.map