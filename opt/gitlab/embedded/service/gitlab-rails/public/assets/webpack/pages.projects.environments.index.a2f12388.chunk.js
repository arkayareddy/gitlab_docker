(this.webpackJsonp=this.webpackJsonp||[]).push([[211],{115:function(t,e,n){n("HVBj"),n("gjpc"),t.exports=n("1pcB")},"1pcB":function(t,e,n){"use strict";n.r(e);n("va8A"),n("kO4A"),n("+kFb"),n("zCcL"),n("zpLX"),n("BD5p"),n("Id6h");var o=n("jB52"),r=n("2/vm"),a=n("GTGS"),i=n("XRO8"),s=n("/lV4"),l={name:"EnvironmentsEmptyState",props:{newPath:{type:String,required:!0},canCreateEnvironment:{type:Boolean,required:!0},helpPath:{type:String,required:!0}}},c=n("tBpV"),p=Object(c.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"empty-state"},[n("div",{staticClass:"text-content"},[n("h4",{staticClass:"blank-state-title js-blank-state-title"},[t._v("\n      "+t._s(t.s__("Environments|You don't have any environments right now"))+"\n    ")]),t._v(" "),n("p",{staticClass:"blank-state-text"},[t._v("\n      "+t._s(t.s__("Environments|Environments are places where\n      code gets deployed, such as staging or production."))+"\n      "),n("a",{attrs:{href:t.helpPath}},[t._v(" "+t._s(t.s__("Environments|Read more about environments"))+" ")])]),t._v(" "),n("div",{staticClass:"text-center"},[t.canCreateEnvironment?n("a",{staticClass:"btn btn-success js-new-environment-button",attrs:{href:t.newPath}},[t._v("\n        "+t._s(t.s__("Environments|New environment"))+"\n      ")]):t._e()])])])}),[],!1,null,null,null).exports,m=n("kJRM"),d=n("aCCI"),u=n("WYZc"),v=n("MV2A"),h=n("1cpz"),f=n("30su"),y=n("XqDB"),g=n("3a3M"),b=n.n(g),_=n("LLbv"),C=n("Y98u"),E=n.n(C),P=n("len0"),S={components:{GlDeprecatedButton:a.a,Icon:P.a},directives:{GlTooltip:_.a},props:{text:{type:String,required:!1,default:""},container:{type:String,required:!1,default:""},cssClasses:{type:String,required:!1,default:""},modalId:{type:String,required:!1,default:""},target:{type:String,required:!1,default:""},title:{type:String,required:!0},tooltipPlacement:{type:String,required:!1,default:"top"},tooltipContainer:{type:String,required:!1,default:null}},copySuccessText:Object(s.a)("Copied"),computed:{modalDomId:function(){return this.modalId?"#".concat(this.modalId):""}},mounted:function(){var t=this;this.$nextTick((function(){t.clipboard=new E.a(t.$el,{container:document.querySelector("".concat(t.modalDomId," div.modal-content"))||document.getElementById(t.container)||document.body}),t.clipboard.on("success",(function(e){t.updateTooltip(e.trigger),t.$emit("success",e),e.clearSelection(),b()(e.trigger).blur()})).on("error",(function(e){return t.$emit("error",e)}))}))},destroyed:function(){this.clipboard&&this.clipboard.destroy()},methods:{updateTooltip:function(t){var e=b()(t),n=e.data("originalTitle");e.tooltip&&(b()(".tooltip").remove(),e.attr("title",this.$options.copySuccessText),e.tooltip("_fixTitle"),e.tooltip("show"),e.attr("title",n),e.tooltip("_fixTitle"))}}},O=Object(c.a)(S,(function(){var t=this.$createElement,e=this._self._c||t;return e("gl-deprecated-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip",value:{placement:this.tooltipPlacement,container:this.tooltipContainer},expression:"{ placement: tooltipPlacement, container: tooltipContainer }"}],class:this.cssClasses,attrs:{"data-clipboard-target":this.target,"data-clipboard-text":this.text,title:this.title}},[this._t("default",[e("icon",{attrs:{name:"copy-to-clipboard"}})])],2)}),[],!1,null,null,null).exports,w={components:{GlDeprecatedButton:a.a,GlLink:v.a,GlModal:h.a,GlSprintf:f.a,ModalCopyButton:O},directives:{"gl-modal":y.a},instructionText:{step1:Object(s.d)("EnableReviewApp|%{stepStart}Step 1%{stepEnd}. Ensure you have Kubernetes set up and have a base domain for your %{linkStart}cluster%{linkEnd}."),step2:Object(s.d)("EnableReviewApp|%{stepStart}Step 2%{stepEnd}. Copy the following snippet:"),step3:Object(s.d)("EnableReviewApp|%{stepStart}Step 3%{stepEnd}. Add it to the project %{linkStart}gitlab-ci.yml%{linkEnd} file.")},modalInfo:{closeText:Object(s.d)("EnableReviewApp|Close"),copyToClipboardText:Object(s.d)("EnableReviewApp|Copy snippet text"),copyString:'deploy_review:\n  stage: deploy\n  script:\n    - echo "Deploy a review app"\n  environment:\n    name: review/$CI_COMMIT_REF_NAME\n    url: https://$CI_ENVIRONMENT_SLUG.example.com\n  only:\n    - branches\n  except:\n    - master',id:"enable-review-app-info",title:Object(s.d)("ReviewApp|Enable Review App")}},k=Object(c.a)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("gl-deprecated-button",{directives:[{name:"gl-modal",rawName:"v-gl-modal",value:t.$options.modalInfo.id,expression:"$options.modalInfo.id"}],staticClass:"js-enable-review-app-button",attrs:{variant:"info",category:"secondary",type:"button"}},[t._v("\n    "+t._s(t.s__("Environments|Enable review app"))+"\n  ")]),t._v(" "),n("gl-modal",{staticClass:"text-2 ws-normal",attrs:{"modal-id":t.$options.modalInfo.id,title:t.$options.modalInfo.title,size:"lg","ok-only":"","ok-variant":"light","ok-title":t.$options.modalInfo.closeText}},[n("p",[n("gl-sprintf",{attrs:{message:t.$options.instructionText.step1},scopedSlots:t._u([{key:"step",fn:function(e){var o=e.content;return[n("strong",[t._v(t._s(o))])]}},{key:"link",fn:function(e){var o=e.content;return[n("gl-link",{attrs:{href:"https://docs.gitlab.com/ee/user/project/clusters/add_remove_clusters.html",target:"_blank"}},[t._v(t._s(o))])]}}])})],1),t._v(" "),n("div",[n("p",[n("gl-sprintf",{attrs:{message:t.$options.instructionText.step2},scopedSlots:t._u([{key:"step",fn:function(e){var o=e.content;return[n("strong",[t._v(t._s(o))])]}}])})],1),t._v(" "),n("div",{staticClass:"flex align-items-start"},[n("pre",{staticClass:"w-100"},[t._v(" "+t._s(t.$options.modalInfo.copyString)+" ")]),t._v(" "),n("modal-copy-button",{attrs:{title:t.$options.modalInfo.copyToClipboardText,text:t.$options.modalInfo.copyString,"modal-id":t.$options.modalInfo.id,"css-classes":"border-0"}})],1)]),t._v(" "),n("p",[n("gl-sprintf",{attrs:{message:t.$options.instructionText.step3},scopedSlots:t._u([{key:"step",fn:function(e){var o=e.content;return[n("strong",[t._v(t._s(o))])]}},{key:"link",fn:function(e){var o=e.content;return[n("gl-link",{attrs:{href:"blob/master/.gitlab-ci.yml",target:"_blank"}},[t._v(t._s(o))])]}}])})],1)])],1)}),[],!1,null,null,null).exports,j=n("Fpys"),D=n("py3j"),x=(n("8Qi2"),n("G3fq")),I=n.n(x),T={name:"ConfirmRollbackModal",components:{GlModal:h.a},props:{environment:{type:Object,required:!0}},computed:{modalTitle:function(){var t=this.environment.isLastDeployment?Object(s.d)("Environments|Re-deploy environment %{name}?"):Object(s.d)("Environments|Rollback environment %{name}?");return Object(s.e)(t,{name:I()(this.environment.name)})},commitShortSha:function(){var t=this.environment.last_deployment;return this.commitData(t,"short_id")},commitUrl:function(){var t=this.environment.last_deployment;return this.commitData(t,"commit_path")},commitTitle:function(){var t=this.environment.last_deployment;return this.commitData(t,"title")},modalText:function(){var t='<a class="commit-sha mr-0" href="'.concat(I()(this.commitUrl),'">'),e=I()(this.commitShortSha),n=I()(this.name),o=this.environment.isLastDeployment?Object(s.d)("Environments|This action will relaunch the job for commit %{linkStart}%{commitId}%{linkEnd}, putting the environment in a previous version. Are you sure you want to continue?"):Object(s.d)("Environments|This action will run the job defined by %{name} for commit %{linkStart}%{commitId}%{linkEnd} putting the environment in a previous version. You can revert it by re-deploying the latest version of your application. Are you sure you want to continue?");return Object(s.e)(o,{commitId:e,linkStart:t,linkEnd:"</a>",name:n},!1)},modalActionText:function(){return this.environment.isLastDeployment?Object(s.d)("Environments|Re-deploy"):Object(s.d)("Environments|Rollback")}},methods:{onOk:function(){m.a.$emit("rollbackEnvironment",this.environment)},commitData:function(t,e){return t&&t.commit?t.commit[e]:""}}},$={components:{ConfirmRollbackModal:Object(c.a)(T,(function(){var t=this.$createElement,e=this._self._c||t;return e("gl-modal",{attrs:{title:this.modalTitle,"modal-id":"confirm-rollback-modal","ok-title":this.modalActionText,"ok-variant":"danger"},on:{ok:this.onOk}},[e("p",{domProps:{innerHTML:this._s(this.modalText)}})])}),[],!1,null,null,null).exports,emptyState:p,EnableReviewAppButton:k,GlDeprecatedButton:a.a,StopEnvironmentModal:j.a,DeleteEnvironmentModal:D.a},mixins:[u.a,d.a],props:{endpoint:{type:String,required:!0},canaryDeploymentFeatureId:{type:String,required:!1,default:""},canCreateEnvironment:{type:Boolean,required:!0},canReadEnvironment:{type:Boolean,required:!0},newEnvironmentPath:{type:String,required:!0},helpCanaryDeploymentsPath:{type:String,required:!1,default:""},helpPagePath:{type:String,required:!0},deployBoardsHelpPath:{type:String,required:!1,default:""},lockPromotionSvgPath:{type:String,required:!1,default:""},showCanaryDeploymentCallout:{type:Boolean,required:!1,default:!1},userCalloutsPath:{type:String,required:!1,default:""}},created:function(){m.a.$on("toggleFolder",this.toggleFolder),m.a.$on("toggleDeployBoard",this.toggleDeployBoard)},beforeDestroy:function(){m.a.$off("toggleFolder"),m.a.$off("toggleDeployBoard")},methods:{toggleDeployBoard:function(t){this.store.toggleDeployBoard(t.id)},toggleFolder:function(t){this.store.toggleFolder(t),t.isOpen||this.fetchChildEnvironments(t,!0)},fetchChildEnvironments:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.store.updateEnvironmentProp(t,"isLoadingFolderContent",n),this.service.getFolderContent(t.folder_path).then((function(n){return e.store.setfolderContent(t,n.data.environments)})).then((function(){return e.store.updateEnvironmentProp(t,"isLoadingFolderContent",!1)})).catch((function(){Object(i.a)(Object(s.d)("Environments|An error occurred while fetching the environments.")),e.store.updateEnvironmentProp(t,"isLoadingFolderContent",!1)}))},successCallback:function(t){var e=this;this.saveData(t);var n=this.store.getOpenFolders();n.length&&n.forEach((function(t){return e.fetchChildEnvironments(t)}))}}},q=Object(c.a)($,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("stop-environment-modal",{attrs:{environment:t.environmentInStopModal}}),t._v(" "),n("delete-environment-modal",{attrs:{environment:t.environmentInDeleteModal}}),t._v(" "),n("confirm-rollback-modal",{attrs:{environment:t.environmentInRollbackModal}}),t._v(" "),n("div",{staticClass:"top-area"},[n("tabs",{attrs:{tabs:t.tabs,scope:"environments"},on:{onChangeTab:t.onChangeTab}}),t._v(" "),n("div",{staticClass:"nav-controls"},[t.state.reviewAppDetails.can_setup_review_app?n("enable-review-app-button",{staticClass:"mr-2"}):t._e(),t._v(" "),t.canCreateEnvironment&&!t.isLoading?n("gl-deprecated-button",{attrs:{href:t.newEnvironmentPath,category:"primary",variant:"success"}},[t._v("\n        "+t._s(t.s__("Environments|New environment"))+"\n      ")]):t._e()],1)],1),t._v(" "),n("container",{attrs:{"is-loading":t.isLoading,environments:t.state.environments,pagination:t.state.paginationInformation,"can-read-environment":t.canReadEnvironment,"canary-deployment-feature-id":t.canaryDeploymentFeatureId,"show-canary-deployment-callout":t.showCanaryDeploymentCallout,"user-callouts-path":t.userCalloutsPath,"lock-promotion-svg-path":t.lockPromotionSvgPath,"help-canary-deployments-path":t.helpCanaryDeploymentsPath,"deploy-boards-help-path":t.deployBoardsHelpPath},on:{onChangePage:t.onChangePage},scopedSlots:t._u([t.isLoading||0!==t.state.environments.length?null:{key:"emptyState",fn:function(){return[n("empty-state",{attrs:{"new-path":t.newEnvironmentPath,"help-path":t.helpPagePath,"can-create-environment":t.canCreateEnvironment}})]},proxy:!0}],null,!0)})],1)}),[],!1,null,null,null).exports,B=n("NmEs"),L=n("0KyK");function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){F(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function F(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}o.default.use(L.a);document.addEventListener("DOMContentLoaded",(function(){return new o.default({el:"#environments-list-view",components:{environmentsComponent:q},mixins:[r.a],data:function(){var t=document.querySelector(this.$options.el).dataset;return{endpoint:t.environmentsDataEndpoint,newEnvironmentPath:t.newEnvironmentPath,helpPagePath:t.helpPagePath,deployBoardsHelpPath:t.deployBoardsHelpPath,canCreateEnvironment:Object(B.H)(t.canCreateEnvironment),canReadEnvironment:Object(B.H)(t.canReadEnvironment)}},render:function(t){return t("environments-component",{props:M({endpoint:this.endpoint,newEnvironmentPath:this.newEnvironmentPath,helpPagePath:this.helpPagePath,deployBoardsHelpPath:this.deployBoardsHelpPath,canCreateEnvironment:this.canCreateEnvironment,canReadEnvironment:this.canReadEnvironment},this.canaryCalloutProps)})}})}))},"2/vm":function(t,e,n){"use strict";var o=n("NmEs");e.a={data:function(){var t=document.querySelector(this.$options.el).dataset;return{canaryDeploymentFeatureId:t.environmentsDataCanaryDeploymentFeatureId,showCanaryDeploymentCallout:Object(o.H)(t.environmentsDataShowCanaryDeploymentCallout),userCalloutsPath:t.environmentsDataUserCalloutsPath,lockPromotionSvgPath:t.environmentsDataLockPromotionSvgPath,helpCanaryDeploymentsPath:t.environmentsDataHelpCanaryDeploymentsPath}},computed:{canaryCalloutProps:function(){return{canaryDeploymentFeatureId:this.canaryDeploymentFeatureId,showCanaryDeploymentCallout:this.showCanaryDeploymentCallout,userCalloutsPath:this.userCalloutsPath,lockPromotionSvgPath:this.lockPromotionSvgPath,helpCanaryDeploymentsPath:this.helpCanaryDeploymentsPath}}}}},"71Sp":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n("FMw2"),n("QifN");var o=n("osXd"),r=n.n(o),a=n("k4Ha"),i=function(t){return r()(t,(function(t,e){return a.k.includes(e)&&t}))}},Fpys:function(t,e,n){"use strict";var o=n("LLbv"),r=n("Mifk"),a=n("/lV4"),i=n("kJRM"),s={id:"stop-environment-modal",name:"StopEnvironmentModal",components:{GlModal:r.a},directives:{GlTooltip:o.a},props:{environment:{type:Object,required:!0}},computed:{noStopActionMessage:function(){return Object(a.e)(Object(a.d)("Environments|Note that this action will stop the environment,\n        but it will %{emphasisStart}not%{emphasisEnd} have an effect on any existing deployment\n        due to no “stop environment action” being defined\n        in the %{ciConfigLinkStart}.gitlab-ci.yml%{ciConfigLinkEnd} file."),{emphasisStart:"<strong>",emphasisEnd:"</strong>",ciConfigLinkStart:'<a href="https://docs.gitlab.com/ee/ci/yaml/" target="_blank" rel="noopener noreferrer">',ciConfigLinkEnd:"</a>"},!1)}},methods:{onSubmit:function(){i.a.$emit("stopEnvironment",this.environment)}}},l=n("tBpV"),c=Object(l.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("gl-modal",{attrs:{id:t.$options.id,"footer-primary-button-text":t.s__("Environments|Stop environment"),"footer-primary-button-variant":"danger"},on:{submit:t.onSubmit},scopedSlots:t._u([{key:"header",fn:function(){return[n("h4",{staticClass:"modal-title d-flex mw-100"},[t._v("\n      Stopping\n      "),n("span",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],staticClass:"text-truncate ml-1 mr-1 flex-fill",attrs:{title:t.environment.name}},[t._v("\n        "+t._s(t.environment.name)+"?\n      ")])])]},proxy:!0}])},[t._v(" "),n("p",[t._v(t._s(t.s__("Environments|Are you sure you want to stop this environment?")))]),t._v(" "),t.environment.has_stop_action?t._e():n("div",{staticClass:"warning_message"},[n("p",{domProps:{innerHTML:t._s(t.noStopActionMessage)}}),t._v(" "),n("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/environments.html#stopping-an-environment",target:"_blank",rel:"noopener noreferrer"}},[t._v(t._s(t.s__("Environments|Learn more about stopping environments")))])])])}),[],!1,null,null,null);e.a=c.exports},WYZc:function(t,e,n){"use strict";n("va8A"),n("9U97"),n("kO4A"),n("+kFb"),n("gyUR"),n("Z5ek"),n("+xU6"),n("zCcL"),n("zpLX"),n("BD5p"),n("MRnW"),n("GzNv"),n("Id6h");var o=n("NmEs"),r=n("71Sp");function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}e.a={methods:{onChangeTab:function(t){var e={scope:t,page:"1"};e=this.onChangeWithFilter(e),this.updateContent(e)},onChangePage:function(t){var e={page:Number(t).toString()};this.scope&&(e.scope=this.scope),e=this.onChangeWithFilter(e),this.updateContent(e)},onChangeWithFilter:function(t){return i(i({},t),Object(r.a)(this.requestData))},updateInternalState:function(t){var e=this;this.poll.stop();var n=Object.keys(t).map((function(n){var o=t[n];return e[n]=o,"".concat(n,"=").concat(encodeURIComponent(o))})).join("&");this.requestData=t,Object(o.t)(Object(o.f)("?".concat(n))),this.isLoading=!0}}}}},[[115,1,0,15,23,32,53]]]);
//# sourceMappingURL=pages.projects.environments.index.a2f12388.chunk.js.map