(this.webpackJsonp=this.webpackJsonp||[]).push([[146],{"1wR6":function(t,e,i){"use strict";i.r(e);var r=i("91Ub");document.addEventListener("DOMContentLoaded",r.a)},51:function(t,e,i){i("HVBj"),t.exports=i("1wR6")},"91Ub":function(t,e,i){"use strict";i("t3Gg");var r=i("3a3M"),a=i.n(r),s=i("2O3R"),n=i("XRO8"),o=i("2ibD"),l=i("/lV4");function u(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.togglePriorityButton,r=e.prioritizedLabels,n=e.otherLabels;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.togglePriorityButton=i||a()(".js-toggle-priority"),this.prioritizedLabels=r||a()(".js-prioritized-labels"),this.otherLabels=n||a()(".js-other-labels"),this.errorMessage=Object(l.a)("Unable to update label prioritization at this time"),this.emptyState=document.querySelector("#js-priority-labels-empty-state"),this.$badgeItemTemplate=a()("#js-badge-item-template"),"sortable"in this.prioritizedLabels.data()&&s.default.create(this.prioritizedLabels.get(0),{filter:".empty-message",forceFallback:!0,fallbackClass:"is-dragging",dataIdAttr:"data-id",onUpdate:this.onPrioritySortUpdate.bind(this)}),this.bindEvents()}var e,i,r;return e=t,(i=[{key:"bindEvents",value:function(){return this.prioritizedLabels.find(".btn-action").on("mousedown",this,this.onButtonActionClick),this.togglePriorityButton.on("click",this,this.onTogglePriorityClick)}},{key:"onTogglePriorityClick",value:function(t){t.preventDefault();var e=t.data,i=a()(t.currentTarget),r=a()("#".concat(i.data("domId"))),s=i.parents(".js-prioritized-labels").length?"remove":"add";a()("#".concat(i.find(".has-tooltip:visible").attr("aria-describedby"))).tooltip("dispose"),e.toggleLabelPriority(r,s),e.toggleEmptyState(r,i,s)}},{key:"onButtonActionClick",value:function(t){t.stopPropagation(),a()(t.currentTarget).tooltip("hide")}},{key:"toggleEmptyState",value:function(){this.emptyState.classList.toggle("hidden",Boolean(this.prioritizedLabels[0].querySelector(":scope > li")))}},{key:"toggleLabelPriority",value:function(t,e,i){null==i&&(i=!0);var r=t.find(".js-toggle-priority").data("url"),a=this.prioritizedLabels,s=this.otherLabels,n=this.rollbackLabelPosition.bind(this,t,e);"remove"===e&&(a=this.otherLabels,s=this.prioritizedLabels);var l=t.detach();this.toggleLabelPriorityBadge(l,e);var u=a.find("li.label-list-item");u.length?u.last().after(l):l.appendTo(a),s.find("li").length&&s.find(".empty-message").removeClass("hidden"),a.find("> li:not(.empty-message)").length&&a.find(".empty-message").addClass("hidden"),i&&("remove"===e?(o.a.delete(r).catch(n),s.find("li").length||s.find(".empty-message").removeClass("hidden")):this.savePrioritySort(t,e).catch(n))}},{key:"toggleLabelPriorityBadge",value:function(t,e){"remove"===e?a()(".js-priority-badge",t).remove():a()(".label-links",t).append(this.$badgeItemTemplate.clone().html())}},{key:"onPrioritySortUpdate",value:function(){var t=this;this.savePrioritySort().catch((function(){return Object(n.a)(t.errorMessage)}))}},{key:"savePrioritySort",value:function(){return o.a.post(this.prioritizedLabels.data("url"),{label_ids:this.getSortedLabelsIds()})}},{key:"rollbackLabelPosition",value:function(t,e){var i="remove"===e?"add":"remove";this.toggleLabelPriority(t,i,!1),Object(n.a)(this.errorMessage)}},{key:"getSortedLabelsIds",value:function(){var t=[];return this.prioritizedLabels.find("> li").each((function(){var e=a()(this).data("id");e&&t.push(e)})),t}}])&&u(e.prototype,i),r&&u(e,r),t}();function b(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d={group:Object(l.a)("Unsubscribe at group level"),project:Object(l.a)("Unsubscribe at project level")},h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var i=a()(e);this.$dropdown=i.find(".dropdown"),this.$subscribeButtons=i.find(".js-subscribe-button"),this.$unsubscribeButtons=i.find(".js-unsubscribe-button"),this.$subscribeButtons.on("click",this.subscribe.bind(this)),this.$unsubscribeButtons.on("click",this.unsubscribe.bind(this))}var e,i,r;return e=t,r=[{key:"setNewTooltip",value:function(t){if(t.hasClass("js-subscribe-button")){var e=t.hasClass("js-group-level")?"group":"project",i=d[e];a()(".js-unsubscribe-button",t.closest(".label-actions-list")).tooltip("hide").attr("title",i).tooltip("_fixTitle")}}}],(i=[{key:"unsubscribe",value:function(t){var e=this;t.preventDefault();var i=this.$unsubscribeButtons.attr("data-url");o.a.post(i).then((function(){e.toggleSubscriptionButtons(),e.$unsubscribeButtons.removeAttr("data-url")})).catch((function(){return Object(n.a)(Object(l.a)("There was an error when unsubscribing from this label."))}))}},{key:"subscribe",value:function(e){var i=this;e.preventDefault();var r=a()(e.currentTarget),s=r.attr("data-url");this.$unsubscribeButtons.attr("data-url",s),o.a.post(s).then((function(){return t.setNewTooltip(r)})).then((function(){return i.toggleSubscriptionButtons()})).catch((function(){return Object(n.a)(Object(l.a)("There was an error when subscribing to this label."))}))}},{key:"toggleSubscriptionButtons",value:function(){this.$dropdown.toggleClass("hidden"),this.$subscribeButtons.toggleClass("hidden"),this.$unsubscribeButtons.toggleClass("hidden")}}])&&b(e.prototype,i),r&&b(e,r),t}();i("Z5ek");function p(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var g={group:{subscribed:Object(l.a)("Unsubscribe at group level"),unsubscribed:Object(l.a)("Subscribe at group level")},project:{subscribed:Object(l.a)("Unsubscribe at project level"),unsubscribed:Object(l.a)("Subscribe at project level")}},f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$container=a()(e),this.$buttons=this.$container.find(".js-subscribe-button"),this.$buttons.on("click",this.toggleSubscription.bind(this))}var e,i,r;return e=t,r=[{key:"setNewTitle",value:function(t,e,i){var r=/group/.test(e)?"group":"project",a=g[r][i];t.attr("title",a).tooltip("_fixTitle")}}],(i=[{key:"toggleSubscription",value:function(e){var i=this;e.preventDefault();var r=a()(e.currentTarget),s=r.attr("data-url"),u=r.attr("data-status");r.addClass("disabled"),o.a.post(s).then((function(){var e,s;if("unsubscribed"===u){var n=["subscribed",Object(l.a)("Unsubscribe")];e=n[0],s=n[1]}else{var o=["unsubscribed",Object(l.a)("Subscribe")];e=o[0],s=o[1]}r.removeClass("disabled"),i.$buttons.attr("data-status",e),i.$buttons.find("> span").text(s),i.$buttons.map((function(i,r){var n=a()(r),o=n.attr("data-original-title");return o&&t.setNewTitle(n,o,e,s),r}))})).catch((function(){return Object(n.a)(Object(l.a)("There was an error subscribing to this label."))}))}}])&&p(e.prototype,i),r&&p(e,r),t}();e.a=function(){a()(".prioritized-labels").length&&new c,a()(".label-subscription").each((function(t,e){var i=a()(e);i.find(".dropdown-group-label").length?new h(i):new f(i)}))}}},[[51,1,0,20]]]);
//# sourceMappingURL=pages.groups.labels.index.2ffbc2de.chunk.js.map