(this.webpackJsonp=this.webpackJsonp||[]).push([[18],{"8/Mu":function(e,t,n){"use strict";n.d(t,"a",(function(){return Dt}));n("va8A"),n("z4I3"),n("dj/k"),n("9U97"),n("+kFb"),n("OZM5"),n("FMw2"),n("S6uq"),n("x/6R"),n("gyUR"),n("Z5ek"),n("4ql4"),n("8Qi2"),n("MRnW"),n("Ag57"),n("IdsT"),n("GzNv"),n("AVOg"),n("QifN"),n("tbvx"),n("l9AF"),n("S26F"),n("TZoF"),n("pBsb"),n("+xeR"),n("Id6h"),n("orcL");var r=n("gAdM"),o=n.n(r),i={issues:"issue-recent-searches",merge_requests:"merge-request-recent-searches"},a=n("NmEs"),c=n("lLWD"),s=n("3twG"),l=n("XRO8"),u=n("nLhi"),p=n("jB52"),d=n("7xOh"),f=Object(d.a)(),h=(n("i1WY"),n("XcF7"));function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"processTokens",value:function(e,t){var n=new RegExp("(".concat(t.join("|"),"):(=|!=)?([~%@]?)(?:('[^']*'{0,1})|(\"[^\"]*\"{0,1})|(\\S+))"),"g"),r=[],o=[],i=null,a=e.replace(n,(function(e,t,n,i,a,c,s){var l,u=a||c||s,p=i,d=n;return"~"!==u&&"%"!==u&&"@"!==u||(p=u,u=""),"!="!==u&&"="!==u||(d=u,u=""),l="".concat(t,":").concat(u),-1===o.indexOf(l)&&(o.push(l),r.push({key:t,value:u||"",symbol:p||"",operator:d||""})),""})).replace(/\s{2,}/g," ").trim()||"";if(r.length>0){var c=r[r.length-1],s="".concat(c.key,":").concat(c.operator).concat(c.symbol).concat(c.value);i=e.lastIndexOf(s)===e.length-s.length?c:a}else i=a;return{tokens:r,lastToken:i,searchToken:a}}}],(n=null)&&y(t.prototype,n),r&&y(t,r),e}(),m={name:"RecentSearchesDropdownContent",props:{items:{type:Array,required:!0},isLocalStorageAvailable:{type:Boolean,required:!1,default:!0},allowedKeys:{type:Array,required:!0}},computed:{processedItems:function(){var e=this;return this.items.map((function(t){var n=v.processTokens(t,e.allowedKeys),r=n.tokens,o=n.searchToken;return{text:t,tokens:r.map((function(e){return{prefix:"".concat(e.key,":"),operator:e.operator,suffix:"".concat(e.symbol).concat(e.value)}})),searchToken:o}}))},hasItems:function(){return this.items.length>0}},methods:{onItemActivated:function(e){f.$emit("recentSearchesItemSelected",e)},onRequestClearRecentSearches:function(e){e.stopPropagation(),f.$emit("requestClearRecentSearches")}}},k=n("tBpV"),g=Object(k.a)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isLocalStorageAvailable?e.hasItems?n("ul",[e._l(e.processedItems,(function(t,r){return n("li",{key:"processed-items-"+r,ref:"dropdownItem",refInFor:!0},[n("button",{staticClass:"filtered-search-history-dropdown-item js-dropdown-button",attrs:{type:"button"},on:{click:function(n){return e.onItemActivated(t.text)}}},[n("span",e._l(t.tokens,(function(t,r){return n("span",{key:"dropdown-token-"+r,staticClass:"filtered-search-history-dropdown-token js-dropdown-token"},[n("span",{staticClass:"name"},[e._v(e._s(t.prefix))]),e._v(" "),n("span",{staticClass:"name"},[e._v(e._s(t.operator))]),e._v(" "),n("span",{staticClass:"value"},[e._v(e._s(t.suffix))])])})),0),e._v(" "),n("span",{staticClass:"filtered-search-history-dropdown-search-token"},[e._v("\n          "+e._s(t.searchToken)+"\n        ")])])])})),e._v(" "),n("li",{staticClass:"divider"}),e._v(" "),n("li",[n("button",{ref:"clearButton",staticClass:"filtered-search-history-clear-button",attrs:{type:"button"},on:{click:function(t){return e.onRequestClearRecentSearches(t)}}},[e._v("\n        "+e._s(e.__("Clear recent searches"))+"\n      ")])])],2):n("div",{ref:"dropdownNote",staticClass:"dropdown-info-note"},[e._v("\n    "+e._s(e.__("You don't have any recent searches"))+"\n  ")]):n("div",{ref:"localStorageNote",staticClass:"dropdown-info-note"},[e._v("\n    "+e._s(e.__("This feature requires local storage to be enabled"))+"\n  ")])])}),[],!1,null,null,null).exports;function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this.service=n,this.wrapperElement=r}var t,n,r;return t=e,(n=[{key:"init",value:function(){this.bindEvents(),this.render()}},{key:"bindEvents",value:function(){this.onRequestClearRecentSearchesWrapper=this.onRequestClearRecentSearches.bind(this),f.$on("requestClearRecentSearches",this.onRequestClearRecentSearchesWrapper)}},{key:"unbindEvents",value:function(){f.$off("requestClearRecentSearches",this.onRequestClearRecentSearchesWrapper)}},{key:"render",value:function(){var e=this.store.state;this.vm=new p.default({el:this.wrapperElement,components:{RecentSearchesDropdownContent:g},data:function(){return e},template:'\n        <recent-searches-dropdown-content\n          :items="recentSearches"\n          :is-local-storage-available="isLocalStorageAvailable"\n          :allowed-keys="allowedKeys"\n          />\n      '})}},{key:"onRequestClearRecentSearches",value:function(){var e=this.store.setRecentSearches([]);this.service.save(e)}},{key:"destroy",value:function(){this.unbindEvents(),this.vm&&this.vm.$destroy()}}])&&b(t.prototype,n),r&&b(t,r),e}(),w=(n("kO4A"),n("zCcL"),n("zpLX"),n("BD5p"),n("d+lS")),T=n.n(w);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({isLocalStorageAvailable:!0,recentSearches:[],allowedKeys:n},t)}var t,n,r;return t=e,(n=[{key:"addRecentSearch",value:function(e){return this.setRecentSearches([e].concat(this.state.recentSearches)),this.state.recentSearches}},{key:"setRecentSearches",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.map((function(e){return e.trim()}));return this.state.recentSearches=T()(t).slice(0,5),this.state.recentSearches}}])&&j(t.prototype,n),r&&j(t,r),e}(),I=(n("jaBk"),n("SG5y"),n("WQYg"),n("EfZm"),n("Tznw"),n("6yen"),n("OeRx"),n("l/dT"),n("RqS2"),n("Zy7a"),n("cjZU"),n("OAhk"),n("X42P"),n("mHhP"),n("fn0I"),n("UB/6"),n("imhG"),n("/lV4"));function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){return!t||"object"!==L(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){var t="function"==typeof Map?new Map:void 0;return(_=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return R(e,arguments,x(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),D(r,e)})(e)}function R(e,t,n){return(R=V()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&D(o,n.prototype),o}).apply(null,arguments)}function V(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(o,e);var t,n,r=(t=o,n=V(),function(){var e,r=x(t);if(n){var o=x(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return P(this,e)});function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e||Object(I.a)("Recent Searches Service is unavailable"))).name="RecentSearchesServiceError",t}return o}(_(Error)),K=n("n7CP");function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var F=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"issuable-recent-searches";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.localStorageKey=t}var t,n,r;return t=e,r=[{key:"isAvailable",value:function(){return K.a.isLocalStorageAccessSafe()}}],(n=[{key:"fetch",value:function(){if(!e.isAvailable()){var t=new A;return Promise.reject(t)}var n=window.localStorage.getItem(this.localStorageKey),r=[];if(n&&n.length>0)try{r=JSON.parse(n)}catch(e){return Promise.reject(e)}return Promise.resolve(r)}},{key:"save",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.isAvailable()&&window.localStorage.setItem(this.localStorageKey,JSON.stringify(t))}}])&&q(t.prototype,n),r&&q(t,r),e}(),W=n("1OWu"),M=(n("arjl"),{keydown:function(e){if(!this.destroyed){var t,n=e.detail.hook.list,r=n.data,o=e.detail.hook.trigger.value.toLowerCase(),i=e.detail.hook.config.Filter,a=[];r&&(t=i&&i.filterFunction&&"function"==typeof i.filterFunction?i.filterFunction:function(e){return e.droplab_hidden=-1===e[i.template].toLowerCase().indexOf(o),e},r.filter((function(e){return!e.droplab_hidden})).length!==(a=r.map((function(e){return t(e,o)}))).filter((function(e){return!e.droplab_hidden})).length&&(n.setData(a),n.currentIndex=0))}},debounceKeydown:function(e){[13,16,17,18,20,37,38,39,40,91,92,93].indexOf(e.detail.which||e.detail.keyCode)>-1||(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(this.keydown.bind(this,e),200))},init:function(e){var t=e.config.Filter;t&&t.template&&(this.hook=e,this.destroyed=!1,this.eventWrapper={},this.eventWrapper.debounceKeydown=this.debounceKeydown.bind(this),this.hook.trigger.addEventListener("keydown.dl",this.eventWrapper.debounceKeydown),this.hook.trigger.addEventListener("mousedown.dl",this.eventWrapper.debounceKeydown))},destroy:function(){this.timeout&&clearTimeout(this.timeout),this.destroyed=!0,this.hook.trigger.removeEventListener("keydown.dl",this.eventWrapper.debounceKeydown),this.hook.trigger.removeEventListener("mousedown.dl",this.eventWrapper.debounceKeydown)}}),B=(n("8pn6"),n("y6Fo"),n("jnfO"),n("Ch9p"),n("t3Gg"),n("+xU6"),n("G3fq")),N=n.n(B),H=["author","assignee"],z="hint",G="operator",U="none",Q="any",$=n("Gs6c"),Z=n("saxb");function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var X=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tokenValue=t,this.tokenType=n,this.tokenOperator=r}var t,r,o;return t=e,o=[{key:"replaceEpicTitle",value:function(e,t,n){var r=e,o=r.querySelector(".value");o&&(r.dataset.originalValue=o.innerText,o.innerText='"'.concat(t,'"::&').concat(n))}},{key:"setTokenStyle",value:function(e,t,n){var r=e;return r.style.backgroundColor=t,r.style.color=n,"#FFFFFF"===n&&r.querySelector(".remove-token").classList.add("inverted"),r}}],(r=[{key:"render",value:function(e,t){var n=this.tokenType,r=this.tokenValue;["none","any"].includes(r.toLowerCase())||("label"===n?this.updateLabelTokenColor(e):H.includes(n)?this.updateUserTokenAppearance(e,t):"my-reaction"===n?this.updateEmojiTokenAppearance(e,t):"epic"===n&&this.updateEpicLabel(e,t))}},{key:"updateUserTokenAppearance",value:function(e,t){var n=this.tokenValue,r=this.tokenValue.replace(/^@/,"");return Z.a.retrieve(r).then((function(r){r&&(e.dataset.originalValue=n,t.innerHTML='\n          <img class="avatar s20" src="'.concat(r.avatar_url,'" alt="">\n          ').concat(N()(r.name),"\n        "))})).catch((function(){}))}},{key:"updateLabelTokenColor",value:function(t){var n=this.tokenValue,r=u.a.container.querySelector(".filtered-search"),o=r.dataset.labelsEndpoint,i=re.getEndpointWithQueryParams("".concat(o,".json"),r.dataset.endpointQueryParams);return $.a.retrieve(i).then((function(r){var o=(r||[]).find((function(e){return"~".concat(ce.getEscapedText(e.title))===n}));o&&e.setTokenStyle(t,o.color,o.text_color)})).catch((function(){return new l.a(Object(I.a)("An error occurred while fetching label colors."))}))}},{key:"updateEpicLabel",value:function(t){var n=this.tokenValue.replace(/^&/,""),r=u.a.container.querySelector(".filtered-search"),o=r.dataset.epicsEndpoint,i=re.getEndpointWithQueryParams("".concat(o,".json"),r.dataset.endpointQueryParams);return $.a.retrieve(i).then((function(r){var o=(r||[]).find((function(e){return e.id===Number(n)}));o&&e.replaceEpicTitle(t,o.title,o.id)})).catch((function(){return new l.a(Object(I.a)("An error occurred while adding formatted title for epic"))}))}},{key:"updateEmojiTokenAppearance",value:function(e,t){var r=e,o=t,i=this.tokenValue;return Promise.resolve().then(n.bind(null,"tDP3")).then((function(e){e.isEmojiNameValid(i)&&(r.dataset.originalValue=i,o.innerHTML=e.glEmojiTag(i))})).catch((function(){}))}}])&&J(t.prototype,r),o&&J(t,o),e}();function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ee,te,ne,re=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getOperatorToken",value:function(t){var n=null;return e.permissibleOperatorValues.forEach((function(e){t.startsWith(e)&&(n=e)})),n}},{key:"getValueToken",value:function(t){var n=t;return e.permissibleOperatorValues.forEach((function(e){t.startsWith(e)&&(n=t.slice(e.length))})),n}},{key:"getLastVisualTokenBeforeInput",value:function(){var e=u.a.container.querySelector(".input-token"),t=e&&e.previousElementSibling;return{lastVisualToken:t,isLastVisualTokenValid:null===t||-1!==t.className.indexOf("filtered-search-term")||t&&null!==t.querySelector(".operator")&&null!==t.querySelector(".value")}}},{key:"unselectTokens",value:function(){var e=u.a.container.querySelectorAll(".js-visual-token .selectable.selected");[].forEach.call(e,(function(e){return e.classList.remove("selected")}))}},{key:"selectToken",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.classList.contains("selected");e.unselectTokens(),r&&!n||t.classList.add("selected")}},{key:"removeSelectedToken",value:function(){var e=u.a.container.querySelector(".js-visual-token .selected");if(e){var t=e.closest(".js-visual-token");t.parentElement.removeChild(t)}}},{key:"createVisualTokenElementHTML",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.canEdit,n=void 0===t||t,r=e.hasOperator,o=void 0!==r&&r,i=e.uppercaseTokenName,a=void 0!==i&&i,c=e.capitalizeTokenValue,s=void 0!==c&&c;return'\n      <div class="'.concat(n?"selectable":"hidden",'" role="button">\n        <div class="').concat(a?"text-uppercase":"",' name"></div>\n        ').concat(o?'<div class="operator"></div>':"",'\n        <div class="value-container">\n          <div class="').concat(s?"text-capitalize":"",' value"></div>\n          <div class="remove-token" role="button">\n            <i class="fa fa-close"></i>\n          </div>\n        </div>\n      </div>\n    ')}},{key:"renderVisualTokenValue",value:function(e,t,n,r){var o=t.toLowerCase(),i=e.querySelector(".value-container"),a=i.querySelector(".value");a.textContent=n,new X(n,o,r).render(i,a)}},{key:"addVisualTokenElement",value:function(t){var n=t.name,r=t.operator,o=t.value,i=t.options,a=void 0===i?{}:i,c=a.isSearchTerm,s=void 0!==c&&c,l=a.canEdit,p=a.uppercaseTokenName,d=a.capitalizeTokenValue,f=a.tokenClass,h=void 0===f?"search-token-".concat(n.toLowerCase()):f,y=document.createElement("li");y.classList.add("js-visual-token"),y.classList.add(s?"filtered-search-term":"filtered-search-token"),s||y.classList.add(h);var v=Boolean(r);if(o)y.innerHTML=e.createVisualTokenElementHTML({canEdit:l,uppercaseTokenName:p,operator:r,hasOperator:v,capitalizeTokenValue:d}),e.renderVisualTokenValue(y,n,o,r);else{var m='<div class="'.concat(p?"text-uppercase":"",' name"></div>'),k="";v&&(k='<div class="operator"></div>'),y.innerHTML=m+k}y.querySelector(".name").textContent=n,v&&(y.querySelector(".operator").textContent=r);var g=u.a.container.querySelector(".tokens-container"),b=u.a.container.querySelector(".filtered-search");g.insertBefore(y,b.parentElement)}},{key:"addValueToPreviousVisualTokenElement",value:function(t){var n=e.getLastVisualTokenBeforeInput(),r=n.lastVisualToken;if(!n.isLastVisualTokenValid&&r.classList.contains("filtered-search-token")){var o=e.getLastTokenPartial(),i=e.getLastTokenOperator();r.innerHTML=e.createVisualTokenElementHTML({hasOperator:Boolean(i)}),r.querySelector(".name").textContent=o,r.querySelector(".operator").textContent=i,e.renderVisualTokenValue(r,o,t,i)}}},{key:"addFilterVisualToken",value:function(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=o.canEdit,a=o.uppercaseTokenName,c=void 0!==a&&a,s=o.capitalizeTokenValue,l=void 0!==s&&s,p=e.getLastVisualTokenBeforeInput(),d=p.lastVisualToken,f=p.isLastVisualTokenValid,h=e.addVisualTokenElement;if(f)h({name:t,operator:n,value:r,options:{canEdit:i,uppercaseTokenName:c,capitalizeTokenValue:l}});else if(f||!d||d.querySelector(".operator")){var y=d.querySelector(".name").textContent,v=d.querySelector(".operator").textContent,m=u.a.container.querySelector(".tokens-container");m.removeChild(d);var k=r;k||n||(k=t),h({name:y,operator:v,value:k,options:{canEdit:i,uppercaseTokenName:c,capitalizeTokenValue:l}})}else{var g=u.a.container.querySelector(".tokens-container");g.removeChild(d),h({name:t,operator:n,value:r,options:{canEdit:i,uppercaseTokenName:c,capitalizeTokenValue:l}})}}},{key:"addSearchVisualToken",value:function(t){var n=e.getLastVisualTokenBeforeInput().lastVisualToken;n&&n.classList.contains("filtered-search-term")?n.querySelector(".name").textContent+=" ".concat(t):e.addVisualTokenElement({name:t,operator:null,value:null,options:{isSearchTerm:!0}})}},{key:"getLastTokenPartial",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e.getLastVisualTokenBeforeInput(),r=n.lastVisualToken;if(!r)return"";var o=r.querySelector(".value-container"),i=o&&o.dataset.originalValue;if(i)return i;var a=r.querySelector(".value"),c=r.querySelector(".name"),s=a?a.textContent:"",l=c?c.textContent:"";if(t){var u=r.querySelector(".operator"),p=u?u.textContent:"";return s||p||l}return s||l}},{key:"getLastTokenOperator",value:function(){var t=e.getLastVisualTokenBeforeInput().lastVisualToken,n=t&&t.querySelector(".operator");return null==n?void 0:n.textContent}},{key:"removeLastTokenPartial",value:function(){var t=e.getLastVisualTokenBeforeInput().lastVisualToken;if(t){var n=t.querySelector(".value"),r=t.querySelector(".operator");if(n){var o=t.querySelector(".selectable"),i=t.querySelector(".value-container");o.removeChild(i),t.innerHTML=o.innerHTML}else r?t.removeChild(r):t.closest(".tokens-container").removeChild(t)}}},{key:"tokenizeInput",value:function(){var t=u.a.container.querySelector(".filtered-search"),n=e.getLastVisualTokenBeforeInput().isLastVisualTokenValid;t.value&&(n?e.addSearchVisualToken(t.value):e.addValueToPreviousVisualTokenElement(t.value),t.value="")}},{key:"getEndpointWithQueryParams",value:function(e,t){if(!t)return e;var n=Object(a.G)(JSON.parse(t));return"".concat(e,"?").concat(n)}},{key:"editToken",value:function(t){var n=u.a.container.querySelector(".filtered-search");e.tokenizeInput();var r=t.parentElement,o=n.parentElement;r.replaceChild(o,t);var i,a=t.querySelector(".name"),c=t.querySelector(".operator");if(t.classList.contains("filtered-search-token")){e.addFilterVisualToken(a.textContent,c.textContent,null,{uppercaseTokenName:a.classList.contains("text-uppercase")});var s=t.querySelector(".value-container");(i=s.dataset.originalValue)||(i=s.querySelector(".value").textContent)}i||(i=a.textContent),n.value=i;var l=new Event("input");n.dispatchEvent(l),n.focus()}},{key:"moveInputToTheRight",value:function(){var t=u.a.container.querySelector(".filtered-search");if(t){var n=t.parentElement,r=u.a.container.querySelector(".tokens-container");if(e.tokenizeInput(),!r.lastElementChild.isEqualNode(n)){if(!e.getLastVisualTokenBeforeInput().isLastVisualTokenValid){var o=e.getLastTokenPartial();e.removeLastTokenPartial(),e.addSearchVisualToken(o)}r.removeChild(n),r.appendChild(n)}}}}],(n=null)&&Y(t.prototype,n),r&&Y(t,r),e}();function oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ie(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ne=["=","!="],(te="permissibleOperatorValues")in(ee=re)?Object.defineProperty(ee,te,{value:ne,enumerable:!0,configurable:!0,writable:!0}):ee[te]=ne;var ce=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getEscapedText",value:function(e){var t=e,n=-1!==e.indexOf(" "),r=-1!==e.indexOf('"');return n&&(t=r?"'".concat(e,"'"):'"'.concat(e,'"')),t}},{key:"filterWithSymbol",value:function(t,n,r){var o=r,i=e.getSearchInput(n),a=o.title.toLowerCase(),c=i.toLowerCase(),s="";c[0]===t&&(s=oe(c,1)[0],c=c.slice(1)),'"'!==c[0]&&"'"!==c[0]||-1===a.indexOf(" ")||(c=c.slice(1));var l=s===t&&-1!==a.indexOf(c),u=-1!==a.indexOf("".concat(s).concat(c));return o.droplab_hidden=!u&&!l,o}},{key:"filterHint",value:function(t,n){var r=t.input,i=t.allowedKeys,a=n,c=e.getSearchQuery(r),s=v.processTokens(c,i),l=s.lastToken,u=s.tokens,p=l.key||l||"",d="array"===n.type,f=u.some((function(e){return e.key===n.hint})),h="search"===a.hint;if(h&&(a.droplab_hidden=!0),!d&&f)a.droplab_hidden=!0;else if(h||p&&" "!==o()(c.split(""))){if(p){var y=p.split(":"),m=o()(y[0].split(" ")),k=h?i.some((function(e){return e.startsWith(m.toLowerCase())})):-1===a.hint.indexOf(m.toLowerCase());a.droplab_hidden=!!m&&k}}else a.droplab_hidden=!1;return a}},{key:"setDataValueIfSelected",value:function(e,t,n){var r=n.getAttribute("data-value");return r&&Lt.addWordToInput({tokenName:e,tokenOperator:t,tokenValue:r,clicked:!0,options:{capitalizeTokenValue:n.hasAttribute("data-capitalize")}}),null!==r}},{key:"getVisualTokenValues",value:function(e){var t=e&&e.querySelector(".name").textContent.trim(),n=e&&e.querySelector(".value")&&e.querySelector(".value").textContent.trim();"label"===t&&n&&(n=n.replace(/^~("|')?(.*)/,"$2").replace(/("|')$/,""));var r=e&&e.querySelector(".operator");return{tokenName:t,tokenOperator:r&&r.textContent.trim(),tokenValue:n}}},{key:"getSearchQuery",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=u.a.container,n=[].slice.call(t.querySelectorAll(".tokens-container li")),r=[];if(e){var o=n.findIndex((function(e){return e.classList.contains("input-token")}));n.splice(o+1)}return n.forEach((function(e){if(e.classList.contains("js-visual-token")){var t=e.querySelector(".name"),n=e.querySelector(".operator"),o=e.querySelector(".value"),i=e.querySelector(".value-container"),a=o&&o.dataset.symbol?o.dataset.symbol:"",c="",s="";n&&(s=n.textContent.trim()),i&&i.dataset.originalValue?c=i.dataset.originalValue:o&&o.innerText&&(c=o.innerText),-1!==e.className.indexOf("filtered-search-token")?r.push("".concat(t.innerText.toLowerCase(),":").concat(s).concat(a).concat(c)):r.push(t.innerText)}else if(e.classList.contains("input-token")){var l=re.getLastVisualTokenBeforeInput().isLastVisualTokenValid,p=u.a.container.querySelector(".filtered-search"),d=p&&p.value;if(l)r.push(d);else{var f=r.pop();r.push("".concat(f).concat(d))}}})),r.map((function(e){return e.trim()})).join(" ")}},{key:"getSearchInput",value:function(t){var n=t.value,r=e.getInputSelectionPosition(t).right;return n.slice(0,r)}},{key:"getInputSelectionPosition",value:function(e){var t=e.selectionStart,n=e.value,r=(n=n.replace(/(('[^']*'{0,1})|("[^"]*"{0,1})|:\s+)/g,(function(e){return e.replace(/\s/g,"_")}))).slice(t).search(/\s/);r>=0?r+=t:r<0&&(r=n.length);var o=n.slice(0,r).search(/\S+$/);return 0===t?o=0:t===n.length&&o<0?o=n.length:o<0&&(o=t),{left:o,right:r}}}],(n=null)&&ae(t.prototype,n),r&&ae(t,r),e}();function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var le=function(){function e(t){var n=t.droplab,r=t.dropdown,o=t.input,i=t.filter;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.droplab=n,this.hookId=o&&o.id,this.input=o,this.filter=i,this.dropdown=r,this.loadingTemplate='<div class="filter-dropdown-loading">\n      <span class="spinner"></span>\n    </div>',this.bindEvents()}var t,n,r;return t=e,r=[{key:"hideDropdownItemsforNotOperator",value:function(e){if("!="===re.getLastTokenOperator()){var t=e.list.list,n=!0;if(Array.from(t.querySelectorAll("li[data-value]")).forEach((function(e){var t=e.dataset.value;t.toLowerCase()===U||t.toLowerCase()===Q?e.classList.add("hidden"):n=!1})),n){var r=t.querySelector("li.divider");r&&r.classList.add("hidden")}}}}],(n=[{key:"bindEvents",value:function(){this.itemClickedWrapper=this.itemClicked.bind(this),this.dropdown.addEventListener("click.dl",this.itemClickedWrapper)}},{key:"unbindEvents",value:function(){this.dropdown.removeEventListener("click.dl",this.itemClickedWrapper)}},{key:"getCurrentHook",value:function(){var e=this;return this.droplab.hooks.filter((function(t){return t.id===e.hookId}))[0]||null}},{key:"itemClicked",value:function(e,t){var n=e.detail.selected;if("LI"===n.tagName&&n.innerHTML){var r=re.getLastVisualTokenBeforeInput().lastVisualToken,o=ce.getVisualTokenValues(r).tokenOperator;if(!ce.setDataValueIfSelected(this.filter,o,n)){var i=t(n);Lt.addWordToInput({tokenName:this.filter,tokenOperator:o,tokenValue:i,clicked:!0})}this.resetFilters(),this.dismissDropdown(),this.dispatchInputEvent()}}},{key:"setAsDropdown",value:function(){this.input.setAttribute("data-dropdown-trigger","#".concat(this.dropdown.id))}},{key:"setOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;window.innerWidth>480?this.dropdown.style.left="".concat(e,"px"):this.dropdown.style.left="0px"}},{key:"renderContent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.getCurrentHook();e.hideDropdownItemsforNotOperator(n),t&&n&&n.list.hidden&&n.list.show()}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.setAsDropdown();var n=this.getCurrentHook(),r=null===n;r||e?this.renderContent(t):n.list.list.id!==this.dropdown.id&&this.renderContent(t)}},{key:"dismissDropdown",value:function(){this.input.focus()}},{key:"dispatchInputEvent",value:function(){this.input.dispatchEvent(new CustomEvent("input",{bubbles:!0,cancelable:!0}))}},{key:"dispatchFormSubmitEvent",value:function(){this.input.form.dispatchEvent(new Event("submit"))}},{key:"hideDropdown",value:function(){var e=this.getCurrentHook();e&&e.list.hide()}},{key:"resetFilters",value:function(){var e=this.getCurrentHook();if(e){var t=e.list.data||[];if(!t)return;var n=t.map((function(e){var t=e;return t.droplab_hidden=!1,t}));e.list.render(n)}}}])&&se(t.prototype,n),r&&se(t,r),e}();function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function de(e,t,n){return(de="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ve(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function fe(e,t){return(fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function he(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ve(e);if(t){var o=ve(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ye(this,n)}}function ye(e,t){return!t||"object"!==ue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ve(e){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fe(e,t)}(i,e);var t,n,r,o=he(i);function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var n=t.input,r=t.tokenKeys;return(e=o.call(this,t)).config={Filter:{template:"hint",filterFunction:ce.filterHint.bind(null,{input:n,allowedKeys:r.getKeys()})}},e.tokenKeys=r,e}return t=i,(n=[{key:"itemClicked",value:function(e){var t=e.detail.selected;if("LI"===t.tagName)if(t.hasAttribute("data-value"))this.dismissDropdown();else if("submit"===t.getAttribute("data-action"))this.dismissDropdown(),this.dispatchFormSubmitEvent();else{var n=t.closest(".filter-dropdown-item").dataset,r=n.hint;if(n.tag.length){var o=this.input.value.split(" "),i=[];o.forEach((function(e,t){i.push(e),t===o.length-1&&-1!==r.indexOf(e.toLowerCase())&&i.pop()})),i.length>0&&re.addSearchVisualToken(i.join(" "));var a=r.replace(":",""),c=this.tokenKeys.searchByKey(a).uppercaseTokenName;Lt.addWordToInput({tokenName:a,clicked:!1,options:{uppercaseTokenName:c}})}this.dismissDropdown(),this.dispatchInputEvent()}}},{key:"renderContent",value:function(){var e=[{hint:"search",tag:"search",formattedKey:Object(I.a)("Search for this text"),icon:"".concat(gon.sprite_icons,"#search")}],t=this.tokenKeys.get().map((function(e){return{icon:"".concat(gon.sprite_icons,"#").concat(e.icon),hint:e.key,tag:":".concat(e.tag),type:e.type,formattedKey:e.formattedKey}})).concat(e);this.droplab.changeHookList(this.hookId,this.dropdown,[M],this.config),this.droplab.setData(this.hookId,t),de(ve(i.prototype),"renderContent",this).call(this)}},{key:"init",value:function(){this.droplab.addHook(this.input,this.dropdown,[M],this.config).init()}}])&&pe(t.prototype,n),r&&pe(t,r),i}(le),ke={init:function(e){this.destroyed=!1,this.hook=e,this.notLoading(),this.eventWrapper={},this.eventWrapper.debounceTrigger=this.debounceTrigger.bind(this),this.hook.trigger.addEventListener("keydown.dl",this.eventWrapper.debounceTrigger),this.hook.trigger.addEventListener("focus",this.eventWrapper.debounceTrigger),this.trigger(!0)},notLoading:function(){this.loading=!1},debounceTrigger:function(e){var t=[16,17,18,20,37,38,39,40,91,93].indexOf(e.detail.which||e.detail.keyCode)>-1,n="focus"===e.type;t||this.loading||(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(this.trigger.bind(this,n),200))},trigger:function(e){var t=this,n=this.hook.config.AjaxFilter,r=this.trigger.value;if(n&&n.endpoint&&n.searchKey){if(n.searchValueFunction&&(r=n.searchValueFunction()),n.loadingTemplate&&void 0===this.hook.list.data||0===this.hook.list.data.length){var o=this.hook.list.list.querySelector("[data-dynamic]"),i=document.createElement("div");i.innerHTML=n.loadingTemplate,i.setAttribute("data-loading-template",!0),this.listTemplate=o.outerHTML,o.outerHTML=i.outerHTML}if(e&&(r=""),n.searchKey===r)return this.list.show();this.loading=!0;var a=n.params||{};a[n.searchKey]=r;var c=n.endpoint+this.buildParams(a);return $.a.retrieve(c).then((function(e){t._loadData(e,n),n.onLoadingFinished&&n.onLoadingFinished(e)})).catch(n.onError)}},_loadData:function(e,t){var n=this.hook.list;if(t.loadingTemplate&&void 0===n.data||0===n.data.length){var r=n.list.querySelector("[data-loading-template]");r&&(r.outerHTML=this.listTemplate)}if(!this.destroyed){var o=n.list.children;1===o.length&&o[0].hasAttribute("data-dynamic")&&0===e.length&&n.hide(),n.setData.call(n,e)}this.notLoading(),n.currentIndex=0},buildParams:function(e){return e?"?"+Object.keys(e).map((function(t){return t+"="+(e[t]||"")})).join("&"):""},destroy:function(){this.timeout&&clearTimeout(this.timeout),this.destroyed=!0,this.hook.trigger.removeEventListener("keydown.dl",this.eventWrapper.debounceTrigger),this.hook.trigger.removeEventListener("focus",this.eventWrapper.debounceTrigger)}};function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Se(e,t,n){return(Se="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ee(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function we(e,t){return(we=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}function Oe(e,t){return!t||"object"!==ge(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var je=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&we(e,t)}(i,e);var t,n,r,o=Te(i);function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var n=t.tokenKeys,r=t.endpoint,a=t.symbol;return(e=o.call(this,t)).tokenKeys=n,e.endpoint=r,e.symbol=a,e.config={AjaxFilter:e.ajaxFilterConfig()},e}return t=i,(n=[{key:"ajaxFilterConfig",value:function(){return{endpoint:"".concat(gon.relative_url_root||"").concat(this.endpoint),searchKey:"search",searchValueFunction:this.getSearchInput.bind(this),loadingTemplate:this.loadingTemplate,onError:function(){Object(l.a)(Object(I.a)("An error occurred fetching the dropdown data."))}}}},{key:"itemClicked",value:function(e){Se(Ee(i.prototype),"itemClicked",this).call(this,e,(function(e){return e.querySelector(".dropdown-light-content").innerText.trim()}))}},{key:"renderContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.droplab.changeHookList(this.hookId,this.dropdown,[ke],this.config),Se(Ee(i.prototype),"renderContent",this).call(this,e)}},{key:"getSearchInput",value:function(){var e=ce.getSearchInput(this.input),t=v.processTokens(e,this.tokenKeys.getKeys()).lastToken||"";return t[0]===this.symbol&&(t=t.slice(1)),'"'!==t[0]&&"'"!==t[0]||(t=t.slice(1)),t}},{key:"init",value:function(){this.droplab.addHook(this.input,this.dropdown,[ke],this.config).init()}}])&&be(t.prototype,n),r&&be(t,r),i}(le);function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){Pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Re(e,t,n){return(Re="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ae(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ve(e,t){return(Ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function De(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ae(e);if(t){var o=Ae(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xe(this,n)}}function xe(e,t){return!t||"object"!==Ce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ae(e){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ve(e,t)}(i,e);var t,n,r,o=De(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,Le(Le({},e),{},{endpoint:"/autocomplete/users.json",symbol:"@"}))}return t=i,(n=[{key:"ajaxFilterConfig",value:function(){var e=this;return Le(Le({},Re(Ae(i.prototype),"ajaxFilterConfig",this).call(this)),{},{params:Le({active:!0,group_id:this.getGroupId(),project_id:this.getProjectId(),current_user:!0},this.projectOrGroupId()),onLoadingFinished:function(){e.hideCurrentUser()}})}},{key:"hideCurrentUser",value:function(){Object(W.a)(this.dropdown.querySelector(".js-current-user"),"hidden")}},{key:"getGroupId",value:function(){return this.input.getAttribute("data-group-id")}},{key:"getProjectId",value:function(){return this.input.getAttribute("data-project-id")}},{key:"projectOrGroupId",value:function(){var e=this.getProjectId(),t=this.getGroupId();return t?{group_id:t}:{project_id:e}}}])&&_e(t.prototype,n),r&&_e(t,r),i}(je),qe={_loadData:function(e,t,n){if(t.loadingTemplate){var r=n.hook.list.list.querySelector("[data-loading-template]");r&&(r.outerHTML=n.listTemplate)}n.destroyed||n.hook.list[t.method].call(n.hook.list,e)},preprocessing:function(e,t){var n=t;return e.preprocessing&&!t.preprocessed&&(n=e.preprocessing(t),$.a.override(e.endpoint,n)),n},init:function(e){var t=this;t.destroyed=!1;var n=e.config.Ajax;if(this.hook=e,n&&n.endpoint&&n.method&&("setData"===n.method||"addData"===n.method)){if(n.loadingTemplate){var r=e.list.list.querySelector("[data-dynamic]"),o=document.createElement("div");o.innerHTML=n.loadingTemplate,o.setAttribute("data-loading-template",""),this.listTemplate=r.outerHTML,r.outerHTML=o.outerHTML}return $.a.retrieve(n.endpoint).then(t.preprocessing.bind(null,n)).then((function(e){return t._loadData(e,n,t)})).catch(n.onError)}},destroy:function(){this.destroyed=!0}};function Fe(e){return(Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Me(e,t,n){return(Me="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ze(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Be(e,t){return(Be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ze(e);if(t){var o=ze(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return He(this,n)}}function He(e,t){return!t||"object"!==Fe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Be(e,t)}(i,e);var t,n,r,o=Ne(i);function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var n=t.input,r=t.endpoint,a=t.symbol,c=t.preprocessing;return(e=o.call(this,t)).symbol=a,e.config={Ajax:{endpoint:r,method:"setData",loadingTemplate:e.loadingTemplate,preprocessing:c,onError:function(){new l.a(Object(I.a)("An error occurred fetching the dropdown data."))}},Filter:{filterFunction:ce.filterWithSymbol.bind(null,e.symbol,n),template:"title"}},e}return t=i,(n=[{key:"itemClicked",value:function(e){var t=this;Me(ze(i.prototype),"itemClicked",this).call(this,e,(function(e){var n=e.querySelector(".js-data-value").innerText.trim();return"".concat(t.symbol).concat(ce.getEscapedText(n))}))}},{key:"renderContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.droplab.changeHookList(this.hookId,this.dropdown,[qe,M],this.config),Me(ze(i.prototype),"renderContent",this).call(this,e)}},{key:"init",value:function(){this.droplab.addHook(this.input,this.dropdown,[qe,M],this.config).init()}}])&&We(t.prototype,n),r&&We(t,r),i}(le);function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qe(e){return function(e){if(Array.isArray(e))return $e(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return $e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $e(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Je(e,t,n){return(Je="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=tt(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Xe(e,t){return(Xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=tt(e);if(t){var o=tt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return et(this,n)}}function et(e,t){return!t||"object"!==Ue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tt(e){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xe(e,t)}(a,e);var t,r,o,i=Ye(a);function a(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,t)).config={Ajax:{endpoint:"".concat(gon.relative_url_root||"","/autocomplete/award_emojis"),method:"setData",loadingTemplate:e.loadingTemplate,onError:function(){new l.a(Object(I.a)("An error occurred fetching the dropdown data."))}},Filter:{template:"name"}},Promise.resolve().then(n.bind(null,"tDP3")).then((function(t){var n=t.glEmojiTag;e.glEmojiTag=n})).catch((function(){})),e.unbindEvents(),e.bindEvents(),e}return t=a,(r=[{key:"bindEvents",value:function(){Je(tt(a.prototype),"bindEvents",this).call(this),this.listRenderedWrapper=this.listRendered.bind(this),this.dropdown.addEventListener("render.dl",this.listRenderedWrapper)}},{key:"unbindEvents",value:function(){this.dropdown.removeEventListener("render.dl",this.listRenderedWrapper),Je(tt(a.prototype),"unbindEvents",this).call(this)}},{key:"listRendered",value:function(){this.replaceEmojiElement()}},{key:"itemClicked",value:function(e){Je(tt(a.prototype),"itemClicked",this).call(this,e,(function(e){var t=e.querySelector(".js-data-value").innerText.trim();return ce.getEscapedText(t)}))}},{key:"renderContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.droplab.changeHookList(this.hookId,this.dropdown,[qe,M],this.config),Je(tt(a.prototype),"renderContent",this).call(this,e)}},{key:"replaceEmojiElement",value:function(){var e=this;this.glEmojiTag&&Qe(this.dropdown.querySelectorAll(".filter-dropdown-item")).forEach((function(t){var n=t.querySelector(".js-data-value");if(null!==n){var r=n.innerText,o=e.glEmojiTag(r);t.querySelector("gl-emoji").outerHTML=o}}))}},{key:"init",value:function(){this.droplab.addHook(this.input,this.dropdown,[qe,M],this.config).init()}}])&&Ze(t.prototype,r),o&&Ze(t,o),a}(le);function rt(e){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function it(e,t,n){return(it="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lt(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function at(e,t){return(at=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=lt(e);if(t){var o=lt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return st(this,n)}}function st(e,t){return!t||"object"!==rt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lt(e){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ut=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&at(e,t)}(i,e);var t,n,r,o=ct(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"renderContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.droplab.changeHookList(this.hookId,this.dropdown,[],this.config),it(lt(i.prototype),"renderContent",this).call(this,e)}}])&&ot(t.prototype,n),r&&ot(t,r),i}(le);function pt(e){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ft(e,t,n){return(ft="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mt(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ht(e,t){return(ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mt(e);if(t){var o=mt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vt(this,n)}}function vt(e,t){return!t||"object"!==pt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mt(e){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ht(e,t)}(i,e);var t,n,r,o=yt(i);function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var n=t.input,r=t.tokenKeys;return(e=o.call(this,t)).config={Filter:{filterFunction:ce.filterWithSymbol.bind(null,"",n),template:"title"}},e.tokenKeys=r,e}return t=i,(n=[{key:"itemClicked",value:function(e){var t=e.detail.selected;if("LI"===t.tagName&&t.hasAttribute("data-value")){var n=re.getLastTokenPartial(),r=t.dataset.value;re.removeLastTokenPartial(),Lt.addWordToInput({tokenName:n,tokenOperator:r,clicked:!1})}this.dismissDropdown(),this.dispatchInputEvent()}},{key:"renderContent",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=[{tag:"equal",type:"string",title:"=",help:Object(I.a)("is")}];(null===(e=gon.features)||void 0===e?void 0:e.notIssuableQueries)&&n.push({tag:"not-equal",type:"string",title:"!=",help:Object(I.a)("is not")}),this.droplab.changeHookList(this.hookId,this.dropdown,[M],this.config),this.droplab.setData(this.hookId,n),ft(mt(i.prototype),"renderContent",this).call(this,t)}},{key:"init",value:function(){this.droplab.addHook(this.input,this.dropdown,[M],this.config).init()}}])&&dt(t.prototype,n),r&&dt(t,r),i}(le);function gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(n),!0).forEach((function(t){St(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function St(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Tt=function(){function e(t){var n=t.container,r=t.runnerTagsEndpoint,o=t.labelsEndpoint,i=t.milestonesEndpoint,a=t.releasesEndpoint,c=t.groupsOnly,s=t.includeAncestorGroups,l=t.includeDescendantGroups;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=n,this.runnerTagsEndpoint=r,this.labelsEndpoint=o,this.milestonesEndpoint=i,this.releasesEndpoint=a,this.groupsOnly=c,this.includeAncestorGroups=s,this.includeDescendantGroups=l,this.filteredSearchInput=this.container.querySelector(".filtered-search")}var t,n,r;return t=e,(n=[{key:"getAllowedMappings",value:function(e){return this.buildMappings(e,this.getMappings())}},{key:"buildMappings",value:function(e,t){var n={hint:{reference:null,gl:me,element:this.container.querySelector("#js-dropdown-hint")},operator:{reference:null,gl:kt,element:this.container.querySelector("#js-dropdown-operator")}};return e.forEach((function(e){t[e]&&(n[e]=t[e])})),n}},{key:"getMappings",value:function(){return{author:{reference:null,gl:Ke,element:this.container.querySelector("#js-dropdown-author")},assignee:{reference:null,gl:Ke,element:this.container.querySelector("#js-dropdown-assignee")},milestone:{reference:null,gl:Ge,extraArguments:{endpoint:this.getMilestoneEndpoint(),symbol:"%"},element:this.container.querySelector("#js-dropdown-milestone")},release:{reference:null,gl:Ge,extraArguments:{endpoint:this.getReleasesEndpoint(),symbol:"",preprocessing:function(e){return e.map((function(e){return bt(bt({},e),{},{title:e.tag})}))}},element:this.container.querySelector("#js-dropdown-release")},label:{reference:null,gl:Ge,extraArguments:{endpoint:this.getLabelsEndpoint(),symbol:"~",preprocessing:ce.duplicateLabelPreprocessing},element:this.container.querySelector("#js-dropdown-label")},"my-reaction":{reference:null,gl:nt,element:this.container.querySelector("#js-dropdown-my-reaction")},wip:{reference:null,gl:Ge,element:this.container.querySelector("#js-dropdown-wip")},confidential:{reference:null,gl:Ge,element:this.container.querySelector("#js-dropdown-confidential")},status:{reference:null,gl:ut,element:this.container.querySelector("#js-dropdown-admin-runner-status")},type:{reference:null,gl:ut,element:this.container.querySelector("#js-dropdown-admin-runner-type")},tag:{reference:null,gl:je,extraArguments:{endpoint:this.getRunnerTagsEndpoint(),symbol:"~"},element:this.container.querySelector("#js-dropdown-runner-tag")},"target-branch":{reference:null,gl:Ge,extraArguments:{endpoint:this.getMergeRequestTargetBranchesEndpoint(),symbol:""},element:this.container.querySelector("#js-dropdown-target-branch")}}}},{key:"getMilestoneEndpoint",value:function(){return"".concat(this.milestonesEndpoint,".json")}},{key:"getReleasesEndpoint",value:function(){return"".concat(this.releasesEndpoint,".json")}},{key:"getLabelsEndpoint",value:function(){var e="".concat(this.labelsEndpoint,".json?");return this.groupsOnly&&(e="".concat(e,"only_group_labels=true&")),this.includeAncestorGroups&&(e="".concat(e,"include_ancestor_groups=true&")),this.includeDescendantGroups&&(e="".concat(e,"include_descendant_groups=true")),e}},{key:"getRunnerTagsEndpoint",value:function(){return"".concat(this.runnerTagsEndpoint,".json")}},{key:"getMergeRequestTargetBranchesEndpoint",value:function(){var e="".concat(gon.relative_url_root||"","/autocomplete/merge_request_target_branches.json"),t={group_id:this.getGroupId(),project_id:this.getProjectId()};return Object(s.n)(t,e)}},{key:"getGroupId",value:function(){return this.filteredSearchInput.getAttribute("data-group-id")||""}},{key:"getProjectId",value:function(){return this.filteredSearchInput.getAttribute("data-project-id")||""}}])&&wt(t.prototype,n),r&&wt(t,r),e}(),Ot=n("Naob");function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(n),!0).forEach((function(t){Ct(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function It(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Lt=function(){function e(t){var n=t.runnerTagsEndpoint,r=void 0===n?"":n,o=t.labelsEndpoint,i=void 0===o?"":o,a=t.milestonesEndpoint,c=void 0===a?"":a,s=t.releasesEndpoint,l=void 0===s?"":s,p=t.epicsEndpoint,d=void 0===p?"":p,f=t.tokenizer,y=t.page,v=t.isGroup,m=t.isGroupAncestor,k=t.isGroupDecendent,g=t.filteredSearchTokenKeys;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var b=function(e){return e.replace(/\/$/,"")};this.container=u.a.container,this.runnerTagsEndpoint=b(r),this.labelsEndpoint=b(i),this.milestonesEndpoint=b(c),this.releasesEndpoint=b(l),this.epicsEndpoint=b(d),this.tokenizer=f,this.filteredSearchTokenKeys=g||h.a,this.filteredSearchInput=this.container.querySelector(".filtered-search"),this.page=y,this.groupsOnly=v,this.includeAncestorGroups=m,this.includeDescendantGroups=k,this.setupMapping(),this.cleanupWrapper=this.cleanup.bind(this),document.addEventListener("beforeunload",this.cleanupWrapper)}var t,n,r;return t=e,r=[{key:"addWordToInput",value:function(e){var t=e.tokenName,n=e.tokenOperator,r=void 0===n?"":n,o=e.tokenValue,i=void 0===o?"":o,a=e.clicked,c=void 0!==a&&a,s=e.options,l=void 0===s?{}:s,p=l.uppercaseTokenName,d=void 0!==p&&p,f=l.capitalizeTokenValue,h=void 0!==f&&f,y=u.a.container.querySelector(".filtered-search");re.addFilterVisualToken(t,r,i,{uppercaseTokenName:d,capitalizeTokenValue:h}),y.value="",c&&re.moveInputToTheRight()}}],(n=[{key:"cleanup",value:function(){this.droplab&&(this.droplab.destroy(),this.droplab=null),this.setupMapping(),document.removeEventListener("beforeunload",this.cleanupWrapper)}},{key:"setupMapping",value:function(){var e=this.filteredSearchTokenKeys.getKeys(),t=new Tt(jt({},this));this.mapping=t.getAllowedMappings(e)}},{key:"updateCurrentDropdownOffset",value:function(){this.updateDropdownOffset(this.currentDropdown)}},{key:"updateDropdownOffset",value:function(e){var t=this.filteredSearchInput.getBoundingClientRect().left-this.container.querySelector(".scroll-container").getBoundingClientRect().left,n=this.mapping[e].element.clientWidth||240,r=this.container.querySelector(".scroll-container").clientWidth-n;r<t&&(t=r),this.mapping[e].reference.setOffset(t)}},{key:"load",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.mapping[e],r=n.gl,o=n.element,i=!1;if(!n.reference){var a={droplab:this.droplab,dropdown:o,input:this.filteredSearchInput,tokenKeys:this.filteredSearchTokenKeys,filter:e},c=n.extraArguments||{},s=jt(jt({},a),c);n.reference=new(Function.prototype.bind.apply(r,[null,s]))}t&&n.reference.init(),this.currentDropdown!==z&&this.currentDropdown!==G||(i=!0),this.updateDropdownOffset(e),n.reference.render(t,i),this.currentDropdown=e}},{key:"loadDropdown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=!1;if(this.droplab||(t=!0,this.droplab=new Ot.a),e!==G){var n=this.filteredSearchTokenKeys.searchByKey(e.toLowerCase()),r=n&&this.currentDropdown!==n.key&&this.mapping[n.key],o=!n&&this.currentDropdown!==z;if(r||o){var i=n&&n.key?n.key:z;this.load(i,t)}}else this.load(e,t)}},{key:"setDropdown",value:function(){var e=ce.getSearchQuery(!0),t=this.tokenizer.processTokens(e,this.filteredSearchTokenKeys.getKeys()),n=t.lastToken,r=t.searchToken;if(this.currentDropdown&&this.updateCurrentDropdownOffset(),n===r&&null!==n){var i=n.split(":"),a=o()(i[0].split(" ")),c=o()(i[1]),s=re.permissibleOperatorValues.includes(c&&c.trim()),l="";if(i.length>1){var u=re.getLastTokenOperator();l=s&&u?a:G}this.loadDropdown(l)}else if(n){var p=re.getLastTokenOperator();this.loadDropdown(p?n.key:G)}else this.loadDropdown(z)}},{key:"resetDropdowns",value:function(){this.currentDropdown&&(this.mapping[this.currentDropdown].reference.hideDropdown(),this.setDropdown(),this.mapping[this.currentDropdown].reference.resetFilters(),this.updateDropdownOffset(this.currentDropdown))}},{key:"destroyDroplab",value:function(){this.droplab.destroy()}}])&&It(t.prototype,n),r&&It(t,r),e}(),Pt=n("IfLy");function _t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Dt=function(){function e(t){var n=t.page,r=t.isGroup,o=void 0!==r&&r,a=t.isGroupAncestor,s=void 0===a||a,l=t.isGroupDecendent,p=void 0!==l&&l,d=t.filteredSearchTokenKeys,f=void 0===d?c.a:d,h=t.stateFiltersSelector,y=void 0===h?".issues-state-filters":h,v=t.placeholder,m=void 0===v?Object(I.a)("Search or filter results..."):v;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isGroup=o,this.isGroupAncestor=s,this.isGroupDecendent=p,this.states=["opened","closed","merged","all"],this.page=n,this.container=u.a.container,this.filteredSearchInput=this.container.querySelector(".filtered-search"),this.filteredSearchInputForm=this.filteredSearchInput.form,this.clearSearchButton=this.container.querySelector(".clear-search"),this.tokensContainer=this.container.querySelector(".tokens-container"),this.filteredSearchTokenKeys=f,this.stateFiltersSelector=y,this.placeholder=m,this.filteredSearchInput.dataset.multipleAssignees&&this.filteredSearchTokenKeys.enableMultipleAssignees&&this.filteredSearchTokenKeys.enableMultipleAssignees(),!this.filteredSearchInput.dataset.epicsEndpoint&&this.filteredSearchTokenKeys.removeEpicToken&&this.filteredSearchTokenKeys.removeEpicToken(),this.recentSearchesStore=new C({isLocalStorageAvailable:F.isAvailable(),allowedKeys:this.filteredSearchTokenKeys.getKeys()}),this.searchHistoryDropdownElement=document.querySelector(".js-filtered-search-history-dropdown");var k=this.searchHistoryDropdownElement?this.searchHistoryDropdownElement.dataset.fullPath:"project",g="".concat(k,"-").concat(i[this.page]);this.recentSearchesService=new F(g)}var t,n,r;return t=e,(n=[{key:"setup",value:function(){var e=this;if(this.fetchingRecentSearchesPromise=this.recentSearchesService.fetch().catch((function(e){if("RecentSearchesServiceError"!==e.name)return new l.a(Object(I.a)("An error occurred while parsing recent searches")),[]})).then((function(t){if(t){var n=e.recentSearchesStore.setRecentSearches(e.recentSearchesStore.state.recentSearches.concat(t));e.recentSearchesService.save(n)}})),this.filteredSearchInput){this.tokenizer=v;var t=this.filteredSearchInput.dataset,n=t.runnerTagsEndpoint,r=void 0===n?"":n,o=t.labelsEndpoint,i=void 0===o?"":o,a=t.milestonesEndpoint,c=void 0===a?"":a,s=t.releasesEndpoint,u=void 0===s?"":s,p=t.epicsEndpoint,d=void 0===p?"":p;this.dropdownManager=new Lt({runnerTagsEndpoint:r,labelsEndpoint:i,milestonesEndpoint:c,releasesEndpoint:u,epicsEndpoint:d,tokenizer:this.tokenizer,page:this.page,isGroup:this.isGroup,isGroupAncestor:this.isGroupAncestor,isGroupDecendent:this.isGroupDecendent,filteredSearchTokenKeys:this.filteredSearchTokenKeys}),this.recentSearchesRoot=new S(this.recentSearchesStore,this.recentSearchesService,this.searchHistoryDropdownElement),this.recentSearchesRoot.init(),this.bindEvents(),this.loadSearchParamsFromURL(),this.dropdownManager.setDropdown(),this.cleanupWrapper=this.cleanup.bind(this),document.addEventListener("beforeunload",this.cleanupWrapper)}}},{key:"cleanup",value:function(){this.unbindEvents(),document.removeEventListener("beforeunload",this.cleanupWrapper),this.recentSearchesRoot&&this.recentSearchesRoot.destroy()}},{key:"bindStateEvents",value:function(){var e=this;this.stateFilters=document.querySelector(".container-fluid ".concat(this.stateFiltersSelector)),this.stateFilters&&(this.searchStateWrapper=this.searchState.bind(this),this.applyToStateFilters((function(t){t.addEventListener("click",e.searchStateWrapper)})))}},{key:"unbindStateEvents",value:function(){var e=this;this.stateFilters&&this.applyToStateFilters((function(t){t.removeEventListener("click",e.searchStateWrapper)}))}},{key:"applyToStateFilters",value:function(e){var t=this;this.stateFilters.querySelectorAll("a[data-state]").forEach((function(n){t.states.indexOf(n.dataset.state)>-1&&e(n)}))}},{key:"bindEvents",value:function(){this.handleFormSubmit=this.handleFormSubmit.bind(this),this.setDropdownWrapper=this.dropdownManager.setDropdown.bind(this.dropdownManager),this.toggleClearSearchButtonWrapper=this.toggleClearSearchButton.bind(this),this.handleInputPlaceholderWrapper=this.handleInputPlaceholder.bind(this),this.handleInputVisualTokenWrapper=this.handleInputVisualToken.bind(this),this.checkForEnterWrapper=this.checkForEnter.bind(this),this.onClearSearchWrapper=this.onClearSearch.bind(this),this.checkForBackspaceWrapper=this.checkForBackspace.call(this),this.checkForMetaBackspaceWrapper=this.checkForMetaBackspace.bind(this),this.checkForAltOrCtrlBackspaceWrapper=this.checkForAltOrCtrlBackspace.bind(this),this.removeSelectedTokenKeydownWrapper=this.removeSelectedTokenKeydown.bind(this),this.unselectEditTokensWrapper=this.unselectEditTokens.bind(this),this.editTokenWrapper=this.editToken.bind(this),this.tokenChange=this.tokenChange.bind(this),this.addInputContainerFocusWrapper=this.addInputContainerFocus.bind(this),this.removeInputContainerFocusWrapper=this.removeInputContainerFocus.bind(this),this.onrecentSearchesItemSelectedWrapper=this.onrecentSearchesItemSelected.bind(this),this.removeTokenWrapper=this.removeToken.bind(this),this.filteredSearchInputForm.addEventListener("submit",this.handleFormSubmit),this.filteredSearchInput.addEventListener("input",this.setDropdownWrapper),this.filteredSearchInput.addEventListener("input",this.toggleClearSearchButtonWrapper),this.filteredSearchInput.addEventListener("input",this.handleInputPlaceholderWrapper),this.filteredSearchInput.addEventListener("keyup",this.handleInputVisualTokenWrapper),this.filteredSearchInput.addEventListener("keydown",this.checkForEnterWrapper),this.filteredSearchInput.addEventListener("keyup",this.checkForBackspaceWrapper),this.filteredSearchInput.addEventListener("keydown",this.checkForMetaBackspaceWrapper),this.filteredSearchInput.addEventListener("keydown",this.checkForAltOrCtrlBackspaceWrapper),this.filteredSearchInput.addEventListener("click",this.tokenChange),this.filteredSearchInput.addEventListener("keyup",this.tokenChange),this.filteredSearchInput.addEventListener("focus",this.addInputContainerFocusWrapper),this.tokensContainer.addEventListener("click",this.removeTokenWrapper),this.tokensContainer.addEventListener("click",this.editTokenWrapper),this.clearSearchButton.addEventListener("click",this.onClearSearchWrapper),document.addEventListener("click",this.unselectEditTokensWrapper),document.addEventListener("click",this.removeInputContainerFocusWrapper),document.addEventListener("keydown",this.removeSelectedTokenKeydownWrapper),f.$on("recentSearchesItemSelected",this.onrecentSearchesItemSelectedWrapper),this.bindStateEvents()}},{key:"unbindEvents",value:function(){this.filteredSearchInputForm.removeEventListener("submit",this.handleFormSubmit),this.filteredSearchInput.removeEventListener("input",this.setDropdownWrapper),this.filteredSearchInput.removeEventListener("input",this.toggleClearSearchButtonWrapper),this.filteredSearchInput.removeEventListener("input",this.handleInputPlaceholderWrapper),this.filteredSearchInput.removeEventListener("keyup",this.handleInputVisualTokenWrapper),this.filteredSearchInput.removeEventListener("keydown",this.checkForEnterWrapper),this.filteredSearchInput.removeEventListener("keydown",this.checkForMetaBackspaceWrapper),this.filteredSearchInput.removeEventListener("keydown",this.checkForAltOrCtrlBackspaceWrapper),this.filteredSearchInput.removeEventListener("keyup",this.checkForBackspaceWrapper),this.filteredSearchInput.removeEventListener("click",this.tokenChange),this.filteredSearchInput.removeEventListener("keyup",this.tokenChange),this.filteredSearchInput.removeEventListener("focus",this.addInputContainerFocusWrapper),this.tokensContainer.removeEventListener("click",this.removeTokenWrapper),this.tokensContainer.removeEventListener("click",this.editTokenWrapper),this.clearSearchButton.removeEventListener("click",this.onClearSearchWrapper),document.removeEventListener("click",this.unselectEditTokensWrapper),document.removeEventListener("click",this.removeInputContainerFocusWrapper),document.removeEventListener("keydown",this.removeSelectedTokenKeydownWrapper),f.$off("recentSearchesItemSelected",this.onrecentSearchesItemSelectedWrapper),this.unbindStateEvents()}},{key:"checkForBackspace",value:function(){var e=this,t=0;return function(n){if(!(n.altKey||n.ctrlKey||n.metaKey))if(n.keyCode===Pt.a||n.keyCode===Pt.b){var r=re.getLastVisualTokenBeforeInput().lastVisualToken,o=ce.getVisualTokenValues(r),i=o.tokenName,a=o.tokenValue,c=i&&e.canEdit&&e.canEdit(i,a);""===e.filteredSearchInput.value&&r&&c&&2===(t+=1)&&(t=0,e.filteredSearchInput.value=re.getLastTokenPartial(!0),re.removeLastTokenPartial()),e.dropdownManager.updateCurrentDropdownOffset()}else t=0}}},{key:"checkForAltOrCtrlBackspace",value:function(e){(e.altKey||e.ctrlKey)&&e.keyCode===Pt.a&&""===this.filteredSearchInput.value&&re.removeLastTokenPartial()}},{key:"checkForMetaBackspace",value:function(e){e.metaKey&&!e.altKey&&!e.ctrlKey&&!e.shiftKey&&e.keyCode===Pt.a&&this.clearSearch()}},{key:"checkForEnter",value:function(e){if(e.keyCode===Pt.f||e.keyCode===Pt.c){var t=this.filteredSearchInput.selectionStart;e.preventDefault(),this.filteredSearchInput.setSelectionRange(t,t)}if(e.keyCode===Pt.d){var n=this.dropdownManager.mapping[this.dropdownManager.currentDropdown].element.querySelectorAll(".droplab-item-active");e.preventDefault(),n.length||(this.isHandledAsync?(e.stopImmediatePropagation(),this.filteredSearchInput.blur(),this.dropdownManager.resetDropdowns()):this.dropdownManager.destroyDroplab(),this.search())}}},{key:"addInputContainerFocus",value:function(){Object(W.a)(this.filteredSearchInput.closest(".filtered-search-box"),"focus")}},{key:"removeInputContainerFocus",value:function(e){var t=this.filteredSearchInput.closest(".filtered-search-box"),n=t&&t.contains(e.target),r=null!==e.target.closest(".filter-dropdown"),o=null!==e.target.closest("ul[data-dropdown]");n||r||o||!t||t.classList.remove("focus")}},{key:"removeToken",value:function(e){if(e.target.closest(".remove-token")){e.preventDefault(),e.stopImmediatePropagation();var t=e.target.closest(".selectable");re.selectToken(t,!0),this.removeSelectedToken()}}},{key:"unselectEditTokens",value:function(e){var t=this.container.querySelector(".filtered-search-box"),n=t&&t.contains(e.target),r=null!==e.target.closest(".filter-dropdown"),o=e.target.classList.contains("tokens-container");(!n&&!r||o)&&(re.moveInputToTheRight(),this.dropdownManager.resetDropdowns())}},{key:"editToken",value:function(e){var t=e.target.closest(".js-visual-token"),n=t&&t.querySelector(".name").textContent.trim(),r=this.canEdit&&this.canEdit(n);t&&r&&(e.preventDefault(),e.stopPropagation(),re.editToken(t),this.tokenChange())}},{key:"toggleClearSearchButton",value:function(){var e=ce.getSearchQuery(),t=this.clearSearchButton.classList.contains("hidden");0!==e.length||t?e.length&&t&&this.clearSearchButton.classList.remove("hidden"):this.clearSearchButton.classList.add("hidden")}},{key:"handleInputPlaceholder",value:function(){var e=ce.getSearchQuery(),t=this.filteredSearchInput.placeholder;0===e.length&&t!==this.placeholder?this.filteredSearchInput.placeholder=this.placeholder:e.length>0&&""!==t&&(this.filteredSearchInput.placeholder="")}},{key:"removeSelectedTokenKeydown",value:function(e){e.keyCode!==Pt.a&&e.keyCode!==Pt.b||this.removeSelectedToken()}},{key:"removeSelectedToken",value:function(){re.removeSelectedToken(),this.handleInputPlaceholder(),this.toggleClearSearchButton(),this.dropdownManager.updateCurrentDropdownOffset()}},{key:"onClearSearch",value:function(e){e.preventDefault(),this.clearSearch()}},{key:"clearSearch",value:function(){var e=this;this.filteredSearchInput.value="";var t=[];[].forEach.call(this.tokensContainer.children,(function(n){var r=n.classList.contains("js-visual-token");if(r){var o=ce.getVisualTokenValues(n),i=o.tokenName,a=o.tokenValue;r=e.canEdit&&e.canEdit(i,a)}r&&t.push(n)})),t.forEach((function(e){e.parentElement.removeChild(e)})),this.clearSearchButton.classList.add("hidden"),this.handleInputPlaceholder(),this.dropdownManager.resetDropdowns(),this.isHandledAsync&&this.search()}},{key:"handleInputVisualToken",value:function(e){var t=this;if(e.keyCode!==Pt.a){var n=this.filteredSearchInput,r=this.tokenizer.processTokens(n.value,this.filteredSearchTokenKeys.getKeys()),i=r.tokens,a=r.searchToken,c=re.getLastVisualTokenBeforeInput().isLastVisualTokenValid;if(c){i.forEach((function(e){n.value=n.value.replace("".concat(e.key,":").concat(e.operator).concat(e.symbol).concat(e.value),""),re.addFilterVisualToken(e.key,e.operator,"".concat(e.symbol).concat(e.value),{uppercaseTokenName:t.filteredSearchTokenKeys.shouldUppercaseTokenName(e.key),capitalizeTokenValue:t.filteredSearchTokenKeys.shouldCapitalizeTokenValue(e.key)})}));var s=a.split(":");if(s.length>1){var l=s[0].split(" "),u=o()(l);if(l.length>1){l.pop();var p=l.join(" ");n.value=n.value.replace(p,""),re.addSearchVisualToken(p)}re.addFilterVisualToken(u,null,null,{uppercaseTokenName:this.filteredSearchTokenKeys.shouldUppercaseTokenName(u),capitalizeTokenValue:this.filteredSearchTokenKeys.shouldCapitalizeTokenValue(u)}),n.value=n.value.replace("".concat(u,":"),"")}}else if(c||re.getLastTokenOperator()){if(a.match(/([~%@]{0,1}".+")|([~%@]{0,1}'.+')|^((?![~%@]')(?![~%@]")(?!')(?!")).*/g)&&" "===n.value[n.value.length-1]){var d=re.getLastTokenPartial();re.addFilterVisualToken(a,null,null,{capitalizeTokenValue:this.filteredSearchTokenKeys.shouldCapitalizeTokenValue(d)}),n.value=n.value.replace(a,"").trim()}}else{var f=re.getLastTokenPartial(),h=a&&a.trim();re.permissibleOperatorValues.includes(h)&&(re.removeLastTokenPartial(),re.addFilterVisualToken(f,h,null,{capitalizeTokenValue:this.filteredSearchTokenKeys.shouldCapitalizeTokenValue(f)}),n.value=n.value.replace(a,"").trim())}}}},{key:"handleFormSubmit",value:function(e){e.preventDefault(),this.search()}},{key:"saveCurrentSearchQuery",value:function(){var e=this;this.fetchingRecentSearchesPromise.then((function(){var t=ce.getSearchQuery();if(t.length>0){var n=e.recentSearchesStore.addRecentSearch(t);e.recentSearchesService.save(n)}})).catch((function(){}))}},{key:"getAllParams",value:function(e){return this.modifyUrlParams?this.modifyUrlParams(e):e}},{key:"transformParams",value:function(t){var n=this,r=new RegExp(/not\[(\w+)\]\[?\]?=(.*)/);return t.map((function(t){var o=t.match(r);if(o&&3===o.length){var i=o[1];if(e.notTransformableQueryParams.includes(i)||n.filteredSearchTokenKeys.searchByConditionUrl(t))return t;var a=o[2],c=encodeURIComponent("!=");return"".concat(i,"=").concat(c).concat(a)}var s=_t(t.split("="),2),l=s[0],u=s[1];if(e.notTransformableQueryParams.includes(l)||n.filteredSearchTokenKeys.searchByConditionUrl(t))return t;var p=encodeURIComponent("=");return"".concat(l,"=").concat(p).concat(u)}))}},{key:"loadSearchParamsFromURL",value:function(){var e=this,t=Object(a.r)(),n=this.transformParams(t),r=this.getAllParams(n),o=this.getUsernameParams(),i=!1;r.forEach((function(t){var n=t.split("="),r=decodeURIComponent(n[0]),a=n[1],c=e.filteredSearchTokenKeys.searchByConditionUrl(t);if(c){i=!0;var s=e.canEdit&&e.canEdit(c.tokenKey);re.addFilterVisualToken(c.tokenKey,c.operator,c.value,{canEdit:s})}else{var l=a?decodeURIComponent(a.replace(/\+/g," ")):a,u=e.filteredSearchTokenKeys.searchByKeyParam(r);if(u){var p=u.key,d=u.symbol,f="";-1!==l.indexOf(" ")&&(f=-1===l.indexOf('"')?'"':"'"),i=!0;var h=e.canEdit&&e.canEdit(p,l),y=u.uppercaseTokenName,v=u.capitalizeTokenValue,m=re.getOperatorToken(l),k=re.getValueToken(l);re.addFilterVisualToken(p,m,"".concat(d).concat(f).concat(k).concat(f),{canEdit:h,uppercaseTokenName:y,capitalizeTokenValue:v})}else if(u||"assignee_id"!==r)if(u||"author_id"!==r)u||"search"!==r||(i=!0,e.filteredSearchInput.value=l);else{var g=parseInt(a,10);if(o[g]){i=!0;var b=e.canEdit&&e.canEdit("author"),S=re.getOperatorToken(o[g]),w=re.getValueToken(o[g]);re.addFilterVisualToken("author",S,"@".concat(w),{canEdit:b})}}else{var T=parseInt(a,10);if(o[T]){i=!0;var O=e.canEdit&&e.canEdit("assignee"),E=re.getOperatorToken(o[T]),j=re.getValueToken(o[T]);re.addFilterVisualToken("assignee",E,"@".concat(j),{canEdit:O})}}}})),this.saveCurrentSearchQuery(),i&&(this.clearSearchButton.classList.remove("hidden"),this.handleInputPlaceholder())}},{key:"searchState",value:function(e){e.preventDefault();var t=e.currentTarget;t.blur();var n=t.dataset&&t.dataset.state;n&&this.search(n)}},{key:"getSearchTokens",value:function(){var e=ce.getSearchQuery();this.saveCurrentSearchQuery();var t=this.filteredSearchTokenKeys.getKeys();return this.tokenizer.processTokens(e,t)}},{key:"search",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=[],r=this.getSearchTokens(),o=r.tokens,i=r.searchToken,c=t||Object(a.o)("state")||"opened";if(n.push("state=".concat(c)),o.forEach((function(t){var r=e.filteredSearchTokenKeys.searchByConditionKeyValue(t.key,t.operator,t.value),o=e.filteredSearchTokenKeys.searchByKey(t.key)||{},i=o.param,a=t.key.replace("-","_"),c=i?"".concat(a,"_").concat(i):a,s="";if(r)s=r.url;else{var l=t.value;if(o.lowercaseValueOnSubmit&&(l=l.toLowerCase()),("'"===l[0]&&"'"===l[l.length-1]||'"'===l[0]&&'"'===l[l.length-1])&&(l=l.slice(1,l.length-1)),"!="===t.operator){var u=c.endsWith("[]");s="not[".concat(u?c.slice(0,-2):c,"]").concat(u?"[]":"","=").concat(encodeURIComponent(l))}else s="".concat(c,"=").concat(encodeURIComponent(l))}n.push(s)})),i){var l=i.split(" ").map((function(e){return encodeURIComponent(e)})).join("+");n.push("search=".concat(l))}var u="?scope=all&utf8=%E2%9C%93&".concat(n.join("&"));this.updateObject?this.updateObject(u):Object(s.z)(u)}},{key:"getUsernameParams",value:function(){var e={};try{var t=this.filteredSearchInput.getAttribute("data-username-params");JSON.parse(t).forEach((function(t){e[t.id]=t.username}))}catch(e){}return e}},{key:"tokenChange",value:function(){var e=this.dropdownManager.mapping[this.dropdownManager.currentDropdown];if(e){var t=e.reference;this.setDropdownWrapper(),t.dispatchInputEvent()}}},{key:"onrecentSearchesItemSelected",value:function(e){this.clearSearch(),this.filteredSearchInput.value=e,this.filteredSearchInput.dispatchEvent(new CustomEvent("input")),this.search()}},{key:"canEdit",value:function(){return!0}}])&&Vt(t.prototype,n),r&&Vt(t,r),e}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Dt,"notTransformableQueryParams",["scope","utf8","state","search"])},"8pn6":function(e,t,n){"use strict";var r=n("ZfjD"),o=n("WG2a").findIndex,i=n("x5C5"),a=n("sRF7"),c=!0,s=a("findIndex");"findIndex"in[]&&Array(1).findIndex((function(){c=!1})),r({target:"Array",proto:!0,forced:c||!s},{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),i("findIndex")},AVOg:function(e,t,n){"use strict";var r,o=n("ZfjD"),i=n("MEJ2").f,a=n("KG2+"),c=n("1005"),s=n("R6g9"),l=n("MkVI"),u=n("PpKG"),p="".endsWith,d=Math.min,f=l("endsWith");o({target:"String",proto:!0,forced:!!(u||f||(r=i(String.prototype,"endsWith"),!r||r.writable))&&!f},{endsWith:function(e){var t=String(s(this));c(e);var n=arguments.length>1?arguments[1]:void 0,r=a(t.length),o=void 0===n?r:d(a(n),r),i=String(e);return p?p.call(t,i,o):t.slice(o-i.length,o)===i}})},HCER:function(e,t,n){var r=n("4ips"),o=1/0;e.exports=function(e){return(null==e?0:e.length)?r(e,o):[]}},IfLy:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s}));var r=8,o=13,i=27,a=38,c=40,s=46},Tb18:function(e,t,n){"use strict";var r=n("kEo8"),o=n("u67S"),i=n("KG2+"),a=n("QCBl"),c=n("sRF7"),s=Math.min,l=[].lastIndexOf,u=!!l&&1/[1].lastIndexOf(1,-0)<0,p=a("lastIndexOf"),d=c("indexOf",{ACCESSORS:!0,1:0}),f=u||!p||!d;e.exports=f?function(e){if(u)return l.apply(this,arguments)||0;var t=r(this),n=i(t.length),a=n-1;for(arguments.length>1&&(a=s(a,o(arguments[1]))),a<0&&(a=n+a);a>=0;a--)if(a in t&&t[a]===e)return a||0;return-1}:l},XcF7:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("9U97"),n("t3Gg"),n("Z5ek"),n("IdsT"),n("S26F");var r=n("/lV4");function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tokenKeys=t,this.alternativeTokenKeys=n,this.conditions=r,this.tokenKeysWithAlternative=this.tokenKeys.concat(this.alternativeTokenKeys)}var t,n,i;return t=e,(n=[{key:"get",value:function(){return this.tokenKeys}},{key:"getKeys",value:function(){return this.tokenKeys.map((function(e){return e.key}))}},{key:"getAlternatives",value:function(){return this.alternativeTokenKeys}},{key:"getConditions",value:function(){return this.conditions}},{key:"shouldUppercaseTokenName",value:function(e){var t=this.searchByKey(e.toLowerCase());return t&&t.uppercaseTokenName}},{key:"shouldCapitalizeTokenValue",value:function(e){var t=this.searchByKey(e.toLowerCase());return t&&t.capitalizeTokenValue}},{key:"searchByKey",value:function(e){return this.tokenKeys.find((function(t){return t.key===e}))||null}},{key:"searchBySymbol",value:function(e){return this.tokenKeys.find((function(t){return t.symbol===e}))||null}},{key:"searchByKeyParam",value:function(e){return this.tokenKeysWithAlternative.find((function(t){var n=t.key;return n=n.replace("-","_"),t.param&&(n+="_".concat(t.param)),e===n}))||null}},{key:"searchByConditionUrl",value:function(e){return this.conditions.find((function(t){return t.url===e}))||null}},{key:"searchByConditionKeyValue",value:function(e,t,n){return this.conditions.find((function(r){return r.tokenKey===e&&r.operator===t&&r.value.toLowerCase()===n.toLowerCase()}))||null}},{key:"addExtraTokensForIssues",value:function(){var e={formattedKey:Object(r.a)("Confidential"),key:"confidential",type:"string",param:"",symbol:"",icon:"eye-slash",tag:Object(r.a)("Yes or No"),lowercaseValueOnSubmit:!0,uppercaseTokenName:!1,capitalizeTokenValue:!0};this.tokenKeys.push(e),this.tokenKeysWithAlternative.push(e)}}])&&o(t.prototype,n),i&&o(t,i),e}()},arjl:function(e,t,n){var r=n("ZfjD"),o=n("wZF9"),i=n("70tN"),a=n("YEnO"),c=n("MEJ2"),s=n("QDZz");r({target:"Reflect",stat:!0},{get:function e(t,n){var r,l,u=arguments.length<3?t:arguments[2];return i(t)===u?t[n]:(r=c.f(t,n))?a(r,"value")?r.value:void 0===r.get?void 0:r.get.call(u):o(l=s(t))?e(l,n,u):void 0}})},gAdM:function(e,t){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},i1WY:function(e,t,n){var r=n("ZfjD"),o=n("Tb18");r({target:"Array",proto:!0,forced:o!==[].lastIndexOf},{lastIndexOf:o})},lLWD:function(e,t,n){"use strict";n("va8A"),n("z4I3"),n("dj/k"),n("9U97"),n("kO4A"),n("+kFb"),n("OZM5"),n("FMw2"),n("x/6R"),n("Z5ek"),n("4ql4"),n("8Qi2"),n("zCcL"),n("zpLX"),n("BD5p"),n("MRnW"),n("IdsT"),n("GzNv"),n("QifN"),n("tbvx"),n("pBsb"),n("Id6h"),n("orcL");var r=n("HCER"),o=n.n(r),i=n("XcF7"),a=n("/lV4");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=[{formattedKey:Object(a.a)("Author"),key:"author",type:"string",param:"username",symbol:"@",icon:"pencil",tag:"@author"},{formattedKey:Object(a.a)("Assignee"),key:"assignee",type:"string",param:"username",symbol:"@",icon:"user",tag:"@assignee"},{formattedKey:Object(a.a)("Milestone"),key:"milestone",type:"string",param:"title",symbol:"%",icon:"clock",tag:"%milestone"},{formattedKey:Object(a.a)("Release"),key:"release",type:"string",param:"tag",symbol:"",icon:"rocket",tag:Object(a.a)("tag name")},{formattedKey:Object(a.a)("Label"),key:"label",type:"array",param:"name[]",symbol:"~",icon:"labels",tag:"~label"}];gon.current_user_id&&d.push({formattedKey:Object(a.a)("My-Reaction"),key:"my-reaction",type:"string",param:"emoji",symbol:"",icon:"thumb-up",tag:"emoji"});var f=[{formattedKey:Object(a.a)("Label"),key:"label",type:"string",param:"name",symbol:"~"}],h=o()([{url:"assignee_id=None",tokenKey:"assignee",value:Object(a.a)("None")},{url:"assignee_id=Any",tokenKey:"assignee",value:Object(a.a)("Any")},{url:"milestone_title=None",tokenKey:"milestone",value:Object(a.a)("None")},{url:"milestone_title=Any",tokenKey:"milestone",value:Object(a.a)("Any")},{url:"milestone_title=%23upcoming",tokenKey:"milestone",value:Object(a.a)("Upcoming")},{url:"milestone_title=%23started",tokenKey:"milestone",value:Object(a.a)("Started")},{url:"release_tag=None",tokenKey:"release",value:Object(a.a)("None")},{url:"release_tag=Any",tokenKey:"release",value:Object(a.a)("Any")},{url:"label_name[]=None",tokenKey:"label",value:Object(a.a)("None")},{url:"label_name[]=Any",tokenKey:"label",value:Object(a.a)("Any")},{url:"my_reaction_emoji=None",tokenKey:"my-reaction",value:Object(a.a)("None")},{url:"my_reaction_emoji=Any",tokenKey:"my-reaction",value:Object(a.a)("Any")}].map((function(e){var t=u(e.url.split("="),2),n=t[0],r=t[1],o=n.includes("[]"),i="not[".concat(o?n.slice(0,-2):n,"]").concat(o?"[]":"","=").concat(r);return[s(s({},e),{},{operator:"="}),s(s({},e),{},{operator:"!=",url:i})]}))),y=new i.a(d,f,h);t.a=y},nLhi:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=document,i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"container",set:function(e){o=e},get:function(){return o}}])&&r(t.prototype,n),i&&r(t,i),e}();t.a=new i}}]);
//# sourceMappingURL=commons~pages.admin.runners~pages.dashboard.issues~pages.dashboard.merge_requests~pages.groups.board~d9c87db9.ea5c2942.chunk.js.map